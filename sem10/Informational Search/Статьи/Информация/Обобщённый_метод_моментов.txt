Обобщённый ме́тод моме́нтов (ОММ; англ. GMM — Generalized Method of Moments) — метод, применяемый в математической статистике и эконометрике для оценки неизвестных параметров распределений и эконометрических моделей, являющийся обобщением классического метода моментов. Метод был предложен Хансеном в 1982 году. В отличие от классического метода моментов количество ограничений может быть больше количества оцениваемых параметров.

Сущность метода
Пусть распределение случайного вектора x зависит от некоторого вектора неизвестных параметров b (количество параметров — k). Пусть также имеются некоторые функции g(x, b) (их количество q не меньше числа оцениваемых параметров), называемые моментными функциями (или просто моментами), для которых из теоретических соображений предполагается, что

  
    
      
        m
        (
        b
        )
        =
        E
        [
        g
        (
        x
        ,
        b
        )
        ]
        =
        0.
      
    
    {\displaystyle m(b)=E[g(x,b)]=0.}
  
Базовая идея метода моментов заключается в использовании в моментных условиях вместо математических ожиданий их выборочные аналоги — выборочные средние

  
    
      
        
          
            
              m
              ^
            
          
        
        (
        b
        )
        =
        
          
            
              g
              (
              x
              ,
              b
              )
            
            ¯
          
        
        ,
      
    
    {\displaystyle {\hat {m}}(b)={\overline {g(x,b)}},}
  
которые согласно закону больших чисел при достаточно слабых условиях должны асимптотически сходится к математическим ожиданиям. Поскольку количество условий на моменты в общем случае больше количества оцениваемых параметров, то однозначного решения эта система ограничений не имеет.
Обобщённым методом моментов (ОММ) называется оценка минимизирующая положительно определённую квадратичную форму от выборочных условий на моменты, в которых вместо математических ожиданий используются выборочные средние:

  
    
      
        
          
            
              
                b
                ^
              
            
          
          
            G
            M
            M
          
        
        =
        arg
        ⁡
        
          min
          
            b
          
        
        
          
            
              m
              ^
            
          
        
        (
        b
        
          )
          
            T
          
        
        W
        
          
            
              m
              ^
            
          
        
        (
        b
        )
        ,
      
    
    {\displaystyle {\hat {b}}_{GMM}=\arg \min _{b}{\hat {m}}(b)^{T}W{\hat {m}}(b),}
  
где W — некоторая симметрическая положительно определённая матрица.
Весовая матрица может быть произвольной (с учётом положительной определённости), однако доказано, что наиболее эффективными являются GMM-оценки с весовой матрицей, равной обратной ковариационной матрице моментных функций 
  
    
      
        W
        =
        
          V
          
            g
          
          
            −
            1
          
        
      
    
    {\displaystyle W=V_{g}^{-1}}
  . Это так называемый эффективный GMM.
Однако, поскольку на практике эта ковариационная матрица неизвестна, то применяют двухшаговую процедуру (двухшаговый GMM — Хансен, 1982 г.):
Шаг 1. Оцениваются параметры модели с помощью GMM с единичной весовой матрицей.
Шаг 2. По выборочным данным и найденным на первом шаге значениям параметров оценивают ковариационную матрицу моментных функций 
  
    
      
        
          
            
              
                V
                ^
              
            
          
          
            g
          
        
        =
        
          
            
              g
              (
              x
              ,
              
                
                  
                    b
                    ^
                  
                
              
              )
              g
              (
              x
              ,
              
                
                  
                    b
                    ^
                  
                
              
              
                )
                
                  T
                
              
            
            ¯
          
        
      
    
    {\displaystyle {\hat {V}}_{g}={\overline {g(x,{\hat {b}})g(x,{\hat {b}})^{T}}}}
   и используют полученную оценку в эффективном GMM.
Эту двухшаговую процедуру можно продолжить (итеративный GMM): используя оценки параметров модели на втором шаге ковариационная матрица моментов оценивается снова и повторно применяется эффективный GMM и т. д. итеративно до достижения требуемой точности.
Также возможен подход к численной минимизации целевой функции 
  
    
      
        
          
            
              
                m
                ^
              
            
          
          
            T
          
        
        (
        b
        )
        
          
            
              
                V
                ^
              
            
          
          
            g
          
          
            −
            1
          
        
        (
        b
        )
        
          
            
              m
              ^
            
          
        
        (
        b
        )
      
    
    {\displaystyle {\hat {m}}^{T}(b){\hat {V}}_{g}^{-1}(b){\hat {m}}(b)}
   по неизвестным параметрам 
  
    
      
        b
      
    
    {\displaystyle b}
  . Тем самым одновременно оцениваются и параметры и ковариационная матрица. Это так называемый непрерывно обновляемый (Continuously Updated) GMM (Хансен, Хитон, Ярон, 1996 год).

Свойства метода
Оценки обобщённого метода моментов при достаточно слабых условиях являются состоятельными, асимптотически нормальными, а оценки эффективного GMM являются также асимптотически эффективными. Можно показать, что

  
    
      
        
          
            n
          
        
        (
        
          
            
              
                b
                ^
              
            
          
          
            G
            M
            M
          
        
        −
        b
        )
        
          
            →
            
              d
            
          
        
        N
        (
        0
        ,
        
          V
          
            b
          
        
        )
        .
      
    
    {\displaystyle {\sqrt {n}}({\hat {b}}_{GMM}-b){\xrightarrow {d}}N(0,V_{b}).}
  В общем случае

  
    
      
        
          V
          
            b
          
        
        =
        (
        
          G
          
            T
          
        
        W
        G
        
          )
          
            −
            1
          
        
        
          G
          
            T
          
        
        W
        
          V
          
            g
          
        
        W
        G
        (
        
          G
          
            T
          
        
        W
        G
        
          )
          
            −
            1
          
        
      
    
    {\displaystyle V_{b}=(G^{T}WG)^{-1}G^{T}WV_{g}WG(G^{T}WG)^{-1}}
  
где G-математическое ожидание матрицы первых производных g по параметрам. В случае эффективного GMM формула ковариационной матрицы существенно упрощается:

  
    
      
        
          V
          
            b
          
        
        =
        
          G
          
            T
          
        
        
          V
          
            g
          
          
            −
            1
          
        
        G
        .
      
    
    {\displaystyle V_{b}=G^{T}V_{g}^{-1}G.}

J-тест
При использовании GMM важным тестом является тест на сверхидентифицирующие ограничения (J-тест). Нулевая гипотеза заключается в том, что условия (ограничения) на моменты имеют место (то есть предположения модели верны). Альтернативная — что они неверны.
Статистика теста равна значению целевой функции GMM, умноженному на количество наблюдений. При нулевой гипотезе

  
    
      
        J
        =
        n
        
          
            
              
                m
                ^
              
            
          
          
            T
          
        
        (
        
          
            
              b
              ^
            
          
        
        )
        
          
            
              
                V
                ^
              
            
          
          
            g
          
          
            −
            1
          
        
        
          
            
              m
              ^
            
          
        
        (
        
          
            
              b
              ^
            
          
        
        )
         
        
          
            →
            
              d
            
          
        
         
        
          χ
          
            2
          
        
        (
        q
        −
        k
        )
        .
      
    
    {\displaystyle J=n{\hat {m}}^{T}({\hat {b}}){\hat {V}}_{g}^{-1}{\hat {m}}({\hat {b}})~{\xrightarrow {d}}~\chi ^{2}(q-k).}
  
Таким образом, если значения статистики больше критического значения распределения 
  
    
      
        
          χ
          
            2
          
        
        (
        q
        −
        k
        )
      
    
    {\displaystyle \chi ^{2}(q-k)}
   при заданном уровне значимости, то ограничения отвергаются (модель неадекватна), в противном случае модель признается адекватной.

См. также
Метод моментов
Метод наименьших квадратов
Метод инструментальных переменных
Метод максимального правдоподобия

Литература
Магнус Я.Р., Катышев П.К., Пересецкий А.А. Эконометрика. Начальный курс. — М.: Дело, 2007. — 504 с. — ISBN 978-5-7749-0473-0.