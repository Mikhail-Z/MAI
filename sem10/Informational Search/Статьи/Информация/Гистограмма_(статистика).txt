Гистогра́мма в математической статистике — это функция, приближающая плотность вероятности некоторого распределения, построенная на основе выборки из него.

Графическое описание
Графически гистограмма строится следующим образом. Сначала множество значений, которое может принимать элемент выборки, разбивается на несколько интервалов (bins). Чаще всего эти интервалы берут одинаковыми, но это не является строгим требованием. Эти интервалы откладываются на горизонтальной оси, затем над каждым рисуется прямоугольник. Если все интервалы были одинаковыми, то высота каждого прямоугольника пропорциональна числу элементов выборки, попадающих в соответствующий интервал. Если интервалы разные, то высота прямоугольника выбирается таким образом, чтобы его площадь была пропорциональна числу элементов выборки, которые попали в этот интервал.

Определение
Пусть 
  
    
      
        
          X
          
            1
          
        
        ,
        …
        ,
        
          X
          
            n
          
        
        ,
        …
      
    
    {\displaystyle X_{1},\ldots ,X_{n},\ldots }
   — выборка из некоторого распределения. Определим разбиение числовой прямой 
  
    
      
        −
        ∞
        <
        
          a
          
            0
          
        
        <
        
          a
          
            1
          
        
        <
        ⋯
        <
        
          a
          
            k
            −
            1
          
        
        <
        
          a
          
            k
          
        
        <
        ∞
      
    
    {\displaystyle -\infty <a_{0}<a_{1}<\cdots <a_{k-1}<a_{k}<\infty }
  . Пусть

  
    
      
        
          n
          
            i
          
        
        =
        
          ∑
          
            j
            =
            1
          
          
            n
          
        
        
          
            1
          
          
            {
            
              X
              
                j
              
            
            ∈
            (
            
              a
              
                i
                −
                1
              
            
            ,
            
              a
              
                i
              
            
            ]
            }
          
        
        ,
        
        
        i
        =
        1
        ,
        …
        ,
        k
      
    
    {\displaystyle n_{i}=\sum \limits _{j=1}^{n}\mathbf {1} _{\{X_{j}\in (a_{i-1},a_{i}]\}},\;\quad i=1,\ldots ,k}
  — число элементов выборки, попавших в 
  
    
      
        i
      
    
    {\displaystyle i}
  -й интервал. Тогда кусочно-постоянная функция 
  
    
      
        
          
            
              h
              ~
            
          
        
        :
        
          R
        
        →
        
          R
        
      
    
    {\displaystyle {\tilde {h}}:\mathbb {R} \to \mathbb {R} }
  , имеющая вид:

  
    
      
        
          
            
              h
              ~
            
          
        
        (
        x
        )
        =
        
          
            
              n
              
                i
              
            
            
              n
              Δ
              
                a
                
                  i
                
              
            
          
        
        ,
        Δ
        
          a
          
            i
          
        
        =
        
          a
          
            i
          
        
        −
        
          a
          
            i
            −
            1
          
        
        ,
        
        i
        =
        1
        ,
        …
        ,
        k
        
      
    
    {\displaystyle {\tilde {h}}(x)={\frac {n_{i}}{n\Delta a_{i}}},\Delta a_{i}=a_{i}-a_{i-1},\;i=1,\ldots ,k\;}
  , — называется нормализованной гистограммой.

Замечание
Нормализованная гистограмма является плотностью вероятности. В частности:

  
    
      
        h
        (
        x
        )
        ≥
        0
        ,
        
        ∀
        x
        ∈
        
          R
        
      
    
    {\displaystyle h(x)\geq 0,\quad \forall x\in \mathbb {R} }
  .

  
    
      
        
          ∫
          
            −
            ∞
          
          
            ∞
          
        
        h
        (
        x
        )
        
        d
        x
        =
        1
      
    
    {\displaystyle \int \limits _{-\infty }^{\infty }h(x)\,dx=1}
  .

Гистограмма абсолютно непрерывного распределения
Пусть распределение случайных величин 
  
    
      
        
          X
          
            i
          
        
      
    
    {\displaystyle X_{i}}
   абсолютно непрерывно и задаётся плотностью вероятности 
  
    
      
        f
        (
        x
        )
      
    
    {\displaystyle f(x)}
  . Тогда

  
    
      
        ∀
        x
        ∈
        (
        
          a
          
            i
            −
            1
          
        
        ,
        
          a
          
            i
          
        
        ]
        ,
        
        h
        (
        x
        )
        
        Δ
        
          a
          
            i
          
        
        ≡
        
          
            
              n
              
                i
              
            
            n
          
        
        →
        
          P
        
        (
        X
        ∈
        (
        
          a
          
            i
            −
            1
          
        
        ,
        
          a
          
            i
          
        
        ]
        )
        ≡
        
          ∫
          
            
              a
              
                i
                −
                1
              
            
          
          
            
              a
              
                i
              
            
          
        
        f
        (
        x
        )
        
        d
        x
        ,
        
        i
        =
        1
        ,
        …
        ,
        k
      
    
    {\displaystyle \forall x\in (a_{i-1},a_{i}],\quad h(x)\,\Delta a_{i}\equiv {\frac {n_{i}}{n}}\to \mathbb {P} (X\in (a_{i-1},a_{i}])\equiv \int \limits _{a_{i-1}}^{a_{i}}f(x)\,dx,\quad i=1,\ldots ,k}
   по вероятности при 
  
    
      
        n
        →
        ∞
      
    
    {\displaystyle n\to \infty }
  .

Замечание
Таким образом площадь фигуры под нормализованной гистограммой, ограниченной интервалом 
  
    
      
        (
        
          a
          
            i
            −
            1
          
        
        ,
        
          a
          
            i
          
        
        ]
      
    
    {\displaystyle (a_{i-1},a_{i}]}
  , приближается к вероятности принятия значений внутри этого интервала любой из случайных величин 
  
    
      
        
          X
          
            j
          
        
      
    
    {\displaystyle X_{j}}
  . Однако, нормализованная гистограмма не сходится поточечно к теоретической плотности распределения этих случайных величин.

Использование
Гистограммы применяются в основном для визуализации данных на начальном этапе статистической обработки.
Построение гистограмм используется для получения эмпирической оценки плотности распределения случайной величины. Для построения гистограммы наблюдаемый диапазон изменения случайной величины разбивается на несколько интервалов и подсчитывается доля от всех измерений, попавшая в каждый из интервалов. Величина каждой доли принимается в качестве оценки вероятности попадания случайной величины в соответствующий интервал. Говорить о плотности вероятности в контексте гистограммы неправильно, т.к. гистограммирование трансформирует распределение любого вида в дискретное (рассматривается событие попадания величины в некоторый интервал, число которых счетно), а для дискретной случайной величины не существует функции плотности распределения вероятностей. 
Существенным для построения гистограммы является выбор оптимального разбиения, поскольку при увеличении интервалов снижается детализация оценки плотности распределения, а при уменьшении падает точность её значения. Для выбора оптимального количества интервалов 
  
    
      
        n
      
    
    {\displaystyle n}
   часто применяется правило Стёрджеса

  
    
      
        n
        =
        1
        +
        ⌊
        
          log
          
            2
          
        
        ⁡
        N
        ⌋
      
    
    {\displaystyle n=1+\lfloor \log _{2}N\rfloor }
  ,где 
  
    
      
        N
      
    
    {\displaystyle N}
   — общее число наблюдений величины, 
  
    
      
        
          log
          
            2
          
        
      
    
    {\displaystyle \log _{2}}
   — логарифм по основанию 2, 
  
    
      
        ⌊
        x
        ⌋
      
    
    {\displaystyle \lfloor x\rfloor }
   — обозначает целую часть числа 
  
    
      
        x
      
    
    {\displaystyle x}
  .
Также часто встречается правило, оценивающее оптимальное количество интервалов как квадратный корень из общего числа измерений:

  
    
      
        n
        =
        ⌊
        
          
            N
          
        
        ⌋
      
    
    {\displaystyle n=\lfloor {\sqrt {N}}\rfloor }

См. также
Выборочная функция распределения