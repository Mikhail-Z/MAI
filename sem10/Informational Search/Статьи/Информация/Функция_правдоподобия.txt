Фу́нкция правдоподо́бия в математической статистике — это совместное распределение выборки из параметрического распределения, рассматриваемое как функция параметра. При этом используется совместная функция плотности (в случае выборки из непрерывного распределения) либо совместная вероятность (в случае выборки из дискретного распределения), вычисленные для данных выборочных значений.
Понятия вероятности и правдоподобия тесно связаны. Сравните два предложения:

«Какова вероятность выпадения 12 очков в каждом из ста бросков двух костей?»
«Насколько правдоподобно, что кости не шулерские, если из ста бросков в каждом выпало 12 очков?»Если распределение вероятности зависит от параметра 
  
    
      
        θ
      
    
    {\displaystyle \theta }
  , то, с одной стороны, можно рассматривать условную вероятность событий 
  
    
      
        x
      
    
    {\displaystyle x}
   при заданном параметре 
  
    
      
        θ
      
    
    {\displaystyle \theta }
  , а с другой стороны — вероятность заданного события 
  
    
      
        X
      
    
    {\displaystyle X}
   при различных значениях параметра 
  
    
      
        θ
      
    
    {\displaystyle \theta }
  . Первый случай соответствует функции, зависящей от события 
  
    
      
        x
      
    
    {\displaystyle x}
  : 
  
    
      
        P
        (
        x
        )
        =
        P
        (
        x
        ∣
        θ
        )
      
    
    {\displaystyle P(x)=P(x\mid \theta )}
  , а второй — функции, зависящей от параметра 
  
    
      
        θ
      
    
    {\displaystyle \theta }
   при фиксированном событии 
  
    
      
        X
      
    
    {\displaystyle X}
  : 
  
    
      
        L
        (
        θ
        )
        =
        L
        (
        x
        =
        X
        ∣
        θ
        )
      
    
    {\displaystyle L(\theta )=L(x=X\mid \theta )}
  . Последнее выражение и есть функция правдоподобия и показывает, насколько правдоподобно выбранное значение параметра 
  
    
      
        θ
      
    
    {\displaystyle \theta }
   при известном событии 
  
    
      
        X
      
    
    {\displaystyle X}
  .
Неформально: если вероятность позволяет нам предсказывать неизвестные результаты, основанные на известных параметрах, то правдоподобие позволяет нам оценивать неизвестные параметры, основанные на известных результатах.

  
    
      
        L
        (
        θ
        ∣
        x
        )
        =
        
          p
          
            θ
          
        
        (
        x
        )
        =
        
          P
          
            θ
          
        
        (
        X
        =
        x
        )
      
    
    {\displaystyle L(\theta \mid x)=p_{\theta }(x)=P_{\theta }(X=x)}
  ,Важно понимать, что по абсолютному значению правдоподобия нельзя делать никаких вероятностных суждений. Правдоподобие позволяет сравнить несколько вероятностных распределений с разными параметрами и оценить в контексте какого из них наблюдаемые события наиболее вероятны.

Определение
Пусть дано параметрическое семейство распределений вероятности 
  
    
      
        {
        
          
            P
          
          
            θ
          
        
        
          }
          
            θ
            ∈
            Θ
          
        
      
    
    {\displaystyle \{\mathbb {P} _{\theta }\}_{\theta \in \Theta }}
  , и дана выборка 
  
    
      
        
          X
          
            1
          
        
        ,
        …
        ,
        
          X
          
            n
          
        
        ∼
        
          
            P
          
          
            θ
          
        
      
    
    {\displaystyle X_{1},\ldots ,X_{n}\sim \mathbb {P} _{\theta }}
   для некоторого 
  
    
      
        θ
        ∈
        Θ
      
    
    {\displaystyle \theta \in \Theta }
  . Предположим, что совместное распределение этой выборки задаётся функцией 
  
    
      
        
          f
          
            
              X
            
          
        
        (
        
          x
        
        ∣
        θ
        )
        ,
        
        
          x
        
        ∈
        
          
            R
          
          
            n
          
        
      
    
    {\displaystyle f_{\mathbf {X} }(\mathbf {x} \mid \theta ),\;\mathbf {x} \in \mathbb {R} ^{n}}
  , где 
  
    
      
        
          f
          
            
              X
            
          
        
      
    
    {\displaystyle f_{\mathbf {X} }}
   является либо плотностью вероятности, либо функцией вероятности случайного вектора 
  
    
      
        
          X
        
        =
        (
        
          X
          
            1
          
        
        ,
        …
        ,
        
          X
          
            n
          
        
        
          )
          
            ⊤
          
        
      
    
    {\displaystyle \mathbf {X} =(X_{1},\ldots ,X_{n})^{\top }}
  .
Для фиксированной реализации выборки 
  
    
      
        
          X
        
        =
        
          x
        
      
    
    {\displaystyle \mathbf {X} =\mathbf {x} }
   функция 
  
    
      
        
          f
          
            
              X
            
          
        
        (
        
          x
        
        ∣
        θ
        )
        :
        Θ
        →
        
          R
        
      
    
    {\displaystyle f_{\mathbf {X} }(\mathbf {x} \mid \theta )\colon \Theta \to \mathbb {R} }
   называется функцией правдоподобия.

Логарифмическая функция правдоподобия
Во многих приложениях необходимо найти максимум функции правдоподобия, что связано с вычислением производной. Логарифм — монотонно возрастающая функция, поэтому логарифм от функции достигнет максимума в той же точке, что и сама функция. С другой стороны, логарифм произведения является суммой, что упрощает дифференцирование. Поэтому для практических вычислений предпочитают использовать логарифм функции правдоподобия.

Функция 
  
    
      
        L
        (
        
          x
        
        ∣
        θ
        )
      
    
    {\displaystyle L(\mathbf {x} \mid \theta )}
  , где
  
    
      
        L
        (
        
          x
        
        ∣
        θ
        )
        =
        ln
        ⁡
        
          f
          
            
              X
            
          
        
        (
        
          x
        
        ∣
        θ
        )
      
    
    {\displaystyle L(\mathbf {x} \mid \theta )=\ln f_{\mathbf {X} }(\mathbf {x} \mid \theta )}
  ,называется логарифми́ческой фу́нкцией правдоподо́бия.

Если выборка независима, то
  
    
      
        
          f
          
            
              X
            
          
        
        (
        
          x
        
        ∣
        θ
        )
        =
        
          ∏
          
            i
            =
            1
          
          
            n
          
        
        
          f
          
            X
          
        
        (
        
          x
          
            i
          
        
        ∣
        θ
        )
      
    
    {\displaystyle f_{\mathbf {X} }(\mathbf {x} \mid \theta )=\prod \limits _{i=1}^{n}f_{X}(x_{i}\mid \theta )}
  ,где 
  
    
      
        
          f
          
            X
          
        
        (
        ⋅
        ∣
        θ
        )
      
    
    {\displaystyle f_{X}(\cdot \mid \theta )}
   — плотность или функция вероятности распределения 
  
    
      
        
          
            P
          
          
            θ
          
        
      
    
    {\displaystyle \mathbb {P} _{\theta }}
  .
Логарифмическая функция правдоподобия в этом случае имеет вид:

  
    
      
        L
        (
        
          x
        
        ∣
        θ
        )
        =
        
          ∑
          
            i
            =
            1
          
          
            n
          
        
        ln
        ⁡
        
          f
          
            X
          
        
        (
        
          x
          
            i
          
        
        ∣
        θ
        )
      
    
    {\displaystyle L(\mathbf {x} \mid \theta )=\sum \limits _{i=1}^{n}\ln f_{X}(x_{i}\mid \theta )}
  .

Замечания
Нельзя путать правдоподобие с вероятностью появления распределения с выбранным параметром. Как минимум, интеграл от функции плотности вероятности по параметру не обязан быть единицей.
Рассмотрим вероятность последовательного выпадания орла в двух бросках одной монеты. Вероятность OO = 
  
    
      
        
          p
          
            O
          
          
            2
          
        
      
    
    {\displaystyle p_{\text{O}}^{2}}
  . Если 
  
    
      
        
          p
          
            O
          
        
        =
        0
        
          ,
        
        5
      
    
    {\displaystyle p_{\text{O}}=0{,}5}
  , то

  
    
      
        P
        (
        
          OO
        
        ∣
        
          p
          
            O
          
        
        =
        0
        
          ,
        
        5
        )
        =
        0
        
          ,
        
        25
      
    
    {\displaystyle P({\text{OO}}\mid p_{\text{O}}=0{,}5)=0{,}25}
  .Правдоподобность того, что вероятность выпадения одного орла равна 0,5, при условии того, что два выпадают с вероятностью 0,25.

  
    
      
        L
        (
        
          p
          
            O
          
        
        =
        0
        
          ,
        
        5
        ∣
        
          OO
        
        )
        =
        P
        (
        
          OO
        
        ∣
        
          p
          
            O
          
        
        =
        0
        
          ,
        
        5
        )
        =
        0
        
          ,
        
        25.
      
    
    {\displaystyle L(p_{\text{O}}=0{,}5\mid {\text{OO}})=P({\text{OO}}\mid p_{\text{O}}=0{,}5)=0{,}25.}
  Но это не то же самое, что «вероятность того, что 
  
    
      
        
          p
          
            O
          
        
        =
        0
        
          ,
        
        5
      
    
    {\displaystyle p_{\text{O}}=0{,}5}
  , если выпало подряд два орла, равна 0,25».
Заметьте, правдоподобность утверждения 
  
    
      
        
          p
          
            O
          
        
        =
        1
      
    
    {\displaystyle p_{\text{O}}=1}
   равна единице.

История
Впервые правдоподобие было упомянуто в книге Торвальда Тиле, опубликованной в 1889 году.
Полное описание идеи правдоподобия впервые было дано Рональдом Фишером в 1922 году в работе «Математические основы теоретической статистики» (англ.). В этой работе Фишер также использует термин метод максимального правдоподобия. Фишер возражает против использования обратной вероятности как основы статистических заключений и предлагает вместо неё использовать функцию правдоподобия.

См. также
Метод максимального правдоподобия


== Примечания ==