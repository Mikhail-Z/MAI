Bluetooth (от слов англ. blue — синий и tooth — зуб; произносится /bluːtuːθ/), блюту́с — производственная спецификация беспроводных персональных сетей (Wireless personal area network, WPAN). Bluetooth обеспечивает обмен информацией между такими устройствами, как персональные компьютеры (настольные, карманные, ноутбуки), мобильные телефоны, интернет-планшеты, принтеры, цифровые фотоаппараты, мышки, клавиатуры, джойстики, наушники, гарнитуры и акустических систем на надёжной, бесплатной, повсеместно доступной радиочастоте для ближней связи. Bluetooth позволяет этим устройствам сообщаться, когда они находятся в радиусе до 10 м друг от друга (дальность сильно зависит от преград и помех), даже в разных помещениях.

Название
Слово Bluetooth — адаптация на английский язык датского слова «Blåtand» («Синезубый»). Так прозвали когда-то короля викингов Харальда I Синезубого, жившего в Дании около тысячи лет назад. Прозвище этот король получил за темный передний зуб. Харальд I правил в X веке Данией и частью Норвегии и объединил враждовавшие датские племена в единое королевство. Подразумевается, что Bluetooth делает то же самое с протоколами связи, объединяя их в один универсальный стандарт. Хотя «blå» в современных скандинавских языках означает «синий», во времена викингов оно также могло означать «чёрного цвета». Таким образом, исторически правильно было бы перевести датское Harald Blåtand скорее как Harald Blacktooth, чем как Harald Bluetooth.
В русском тексте портал Грамота.ру предпочтительным называет использование написания «Bluetooth», а допустимым — «блюту́с».Логотип Bluetooth является сочетанием двух нордических («скандинавских») рун: Хагалаз младшего футарка (ᚼ) и Беркана (ᛒ), звуковые значения которых соответствуют инициалам Харальда I Синезубого — h и b (дат. Harald Blåtand, норв. Harald Blåtann). Логотип похож на более старый логотип для Beauknit Textiles, подразделения корпорации Beauknit. В нём используется слияние отраженной K и В для «Beauknit», он шире и имеет скругленные углы, но в общем он такой же.

История создания и развития
Работы по созданию Bluetooth начал производитель телекоммуникационного оборудования Ericsson в 1994 году как беспроводную альтернативу кабелям RS-232. Первоначально эта технология была приспособлена под потребности системы FLYWAY в функциональном интерфейсе между путешественниками и системой.
Спецификация Bluetooth была разработана группой Bluetooth Special Interest Group (Bluetooth SIG), которая была основана в 1998 году. В неё вошли компании Ericsson, IBM, Intel, Toshiba и Nokia. Впоследствии Bluetooth SIG и IEEE достигли соглашения, на основе которого спецификация Bluetooth стала частью стандарта IEEE 802.15.1 (дата опубликования — 14 июня 2002 года).

Принцип действия Bluetooth
Принцип действия основан на использовании радиоволн. Радиосвязь Bluetooth осуществляется в ISM-диапазоне (англ. Industry, Science and Medicine), который используется в различных бытовых приборах и беспроводных сетях (свободный от лицензирования диапазон 2,4-2,4835 ГГц). В Bluetooth применяется метод расширения спектра со скачкообразной перестройкой частоты (англ. Frequency Hopping Spread Spectrum, FHSS). Метод FHSS прост в реализации, обеспечивает устойчивость к широкополосным помехам, а оборудование недорогое.
Согласно алгоритму FHSS, в Bluetooth несущая частота сигнала скачкообразно меняется 1600 раз в секунду (всего выделяется 79 рабочих частот шириной в 1 МГц, а в Японии, Франции и Испании полоса у́же — 23 частотных канала). Последовательность переключения между частотами для каждого соединения является псевдослучайной и известна только передатчику и приёмнику, которые каждые 625 мкс (один временной слот) синхронно перестраиваются с одной несущей частоты на другую. Таким образом, если рядом работают несколько пар приёмник-передатчик, то они не мешают друг другу. Этот алгоритм является также составной частью системы защиты конфиденциальности передаваемой информации: переход происходит по псевдослучайному алгоритму и определяется отдельно для каждого соединения. При передаче цифровых данных и аудиосигнала (64 кбит/с в обоих направлениях) используются различные схемы кодирования: аудиосигнал не повторяется (как правило), а цифровые данные в случае утери пакета информации будут переданы повторно.
Протокол Bluetooth поддерживает не только соединение «point-to-point», но и соединение «point-to-multipoint».

Спецификации
Bluetooth 1.0
Устройства версий 1.0 (1998) и 1.0B имели плохую совместимость между продуктами различных производителей. В 1.0 и 1.0B была обязательной передача адреса устройства (BD_ADDR) на этапе установления связи, что делало невозможной реализацию анонимности соединения на протокольном уровне и было основным недостатком данной спецификации.

Bluetooth 1.1
В Bluetooth 1.1 было исправлено множество ошибок, найденных в 1.0B, добавлена поддержка для нешифрованных каналов, индикация уровня мощности принимаемого сигнала (RSSI).

Bluetooth 1.2
Главные улучшения включают следующее:

Быстрое подключение и обнаружение.
Адаптивная перестройка частоты с расширенным спектром (AFH), которая повышает стойкость к радиопомехам.
Более высокие, чем в 1.1, скорости передачи данных, практически до 1 Мбит/с.
Расширенные Синхронные Подключения (eSCO), которые улучшают качество передачи голоса в аудиопотоке, позволяя повторную передачу повреждённых пакетов, и при необходимости могут увеличить задержку аудио, чтобы оказать лучшую поддержку для параллельной передачи данных.
В Host Controller Interface (HCI) добавлена поддержка трёхпроводного интерфейса UART.
Утверждён как стандарт IEEE Standard 802.15.1-2005.
Введены режимы управления потоком данных (Flow Control) и повторной передачи (Retransmission Modes) для L2CAP.

Bluetooth 2.0 + EDR
Bluetooth версии 2.0 был выпущен 10 ноября 2004 г. Имеет обратную совместимость с предыдущими версиями 1.x. Основным нововведением стала поддержка Enhanced Data Rate (EDR) для ускорения передачи данных. Номинальная скорость EDR около 3 Мбит/с, однако на практике это позволило повысить скорость передачи данных только до 2,1 Мбит/с. Дополнительная производительность достигается с помощью различных радиотехнологий для передачи данных.
Стандартная (базовая) скорость передачи данных использует GFSK-модуляцию радиосигнала при скорости передачи в 1 Мбит/с. EDR использует сочетание модуляций GFSK и PSK с двумя вариантами, π/4-DQPSK и 8DPSK. Они имеют большие скорости передачи данных по воздуху — 2 и 3 Мбит/с соответственно.
Bluetooth SIG издала спецификацию как «Технология Bluetooth 2.0 + EDR», которая подразумевает, что EDR является дополнительной функцией. Кроме EDR, есть и другие незначительные усовершенствования к 2.0 спецификации, и продукты могут соответствовать «Технологии Bluetooth 2.0», не поддерживая более высокую скорость передачи данных. По крайней мере одно коммерческое устройство, HTC TyTN Pocket PC, использует «Bluetooth 2.0 без EDR» в своих технических спецификациях.
Согласно 2.0 + EDR спецификации, EDR обеспечивает следующие преимущества:

Увеличение скорости передачи в 3 раза (2,1 Мбит/с) в некоторых случаях.
Уменьшение сложности нескольких одновременных подключений из-за дополнительной полосы пропускания.
Снижение потребления энергии благодаря уменьшению нагрузки.

Bluetooth 2.1
2007 год. Добавлена технология расширенного запроса характеристик устройства (для дополнительной фильтрации списка при сопряжении), энергосберегающая технология Sniff Subrating, которая позволяет увеличить продолжительность работы устройства от одного заряда аккумулятора в 3—10 раз. Кроме того, обновлённая спецификация существенно упрощает и ускоряет установление связи между двумя устройствами, позволяет производить обновление ключа шифрования без разрыва соединения, а также делает указанные соединения более защищёнными, благодаря использованию технологии Near Field Communication.

Bluetooth 2.1 + EDR
В августе 2008 года Bluetooth SIG представила версию 2.1+EDR. Новая редакция Bluetooth снижает потребление энергии в 5 раз, повышает уровень защиты данных и облегчает распознавание и соединение Bluetooth-устройств благодаря уменьшению количества шагов, за которые оно выполняется.

Bluetooth 3.0 + HS
3.0+HS была принята Bluetooth SIG 21 апреля 2009 года. Она поддерживает теоретическую скорость передачи данных до 24 Мбит/с. Её основной особенностью является добавление AMP (Alternate MAC/PHY), дополнение к 802.11 как высокоскоростное сообщение. Для AMP были предусмотрены две технологии: 802.11 и UWB, но UWB отсутствует в спецификации.
Модули с поддержкой новой спецификации соединяют в себе две радиосистемы: первая обеспечивает передачу данных в 3 Мбит/с (стандартная для Bluetooth 2.0) и имеет низкое энергопотребление; вторая совместима со стандартом 802.11 и обеспечивает возможность передачи данных со скоростью до 24 Мбит/с (сравнима со скоростью сетей Wi-Fi). Выбор радиосистемы для передачи данных зависит от размера передаваемого файла. Небольшие файлы передаются по медленному каналу, а большие — по высокоскоростному. Bluetooth 3.0 использует более общий стандарт 802.11 (без суффикса), то есть несовместим с такими спецификациями Wi-Fi, как 802.11b/g или 802.11n.

Bluetooth 4.0
Bluetooth SIG утвердил спецификацию Bluetooth 4.0 30 июня 2010 года. Bluetooth 4.0 включает в себя протоколы:

Классический Bluetooth,
Высокоскоростной Bluetooth
Bluetooth с низким энергопотреблением.Высокоскоростной Bluetooth основан на Wi-Fi, а Классический Bluetooth состоит из протоколов предыдущих спецификаций Bluetooth.
Частоты работы системы Bluetooth (мощность не более 0,0025 Вт).
Полоса частот: 2 402 000 000 — 2 480 000 000 Гц (2,402 ГГц — 2,48 ГГц)
Протокол Bluetooth с низким энергопотреблением предназначен, прежде всего, для миниатюрных электронных датчиков (использующихся в спортивной обуви, тренажёрах, миниатюрных сенсорах, размещаемых на теле пациентов и т. д.). Низкое энергопотребление достигается за счёт использования особого алгоритма работы. Передатчик включается только на время отправки данных, что обеспечивает возможность работы от одной батарейки типа CR2032 в течение нескольких лет. Стандарт предоставляет скорость передачи данных в 1 Мбит/с при размере пакета данных 8—27 байт. В новой версии два Bluetooth-устройства смогут устанавливать соединение менее чем за 5 миллисекунд и поддерживать его на расстоянии до 100 м. Для этого используется усовершенствованная коррекция ошибок, а необходимый уровень безопасности обеспечивает 128-битное AES-шифрование.
Датчики температуры, давления, влажности, скорости передвижения и т. д. на базе этого стандарта могут передавать информацию на различные устройства контроля: мобильные телефоны, КПК, ПК и т. п.
Первый чип с поддержкой Bluetooth 3.0 и Bluetooth 4.0 был выпущен компанией ST-Ericsson в конце 2009 года. В настоящее время выпускается большое количество мобильных устройств с поддержкой этого стандарта.

Bluetooth 4.1
В конце 2013 года Bluetooth Special Interest Group (SIG) представила спецификацию Bluetooth 4.1.
Одно из улучшений, реализованных в спецификации Bluetooth 4.1, касается совместной работы Bluetooth и мобильной связи четвёртого поколения LTE. Стандарт предусматривает защиту от взаимных помех путём автоматического координирования передачи пакетов данных.

Bluetooth 4.2
3 декабря 2014 Bluetooth Special Interest Group (SIG) представила спецификацию Bluetooth 4.2.. Основные улучшения — повышение конфиденциальности и увеличение скорости передачи данных.

Bluetooth 5.0
16 июня 2016 года Bluetooth Special Interest Group (SIG) представила спецификацию Bluetooth 5.0. Изменения коснулись в основном режима с низким потреблением и высокоскоростного режима. Радиус действия увеличен в 4 раза, скорость увеличена в 2 раза.

Bluetooth 5.1
Совсем скоро появится новая версия Bluetooth 5.1. По словам разработчиков, от предыдущих версий Bluetooth 5.1 будет отличаться тем, что с ней у пользователей будет возможность определять местоположение и направление с максимальной точностью.

Стек протоколов Bluetooth
Bluetooth имеет многоуровневую архитектуру, состоящую из основного протокола, протоколов замены кабеля, протоколов управления телефонией и заимствованных протоколов. Обязательными протоколами для всех стеков Bluetooth являются: LMP, L2CAP и SDP. Кроме того, устройства, связывающиеся с Bluetooth обычно используют протоколы HCI и RFCOMM.

LMP
Link Management Protocol — используется для установления и управления радиосоединением между двумя устройствами. Реализуется контроллером Bluetooth.
HCI
Host/controller interface — определяет связь между стеком хоста (то есть компьютера или мобильного устройства) и контроллером Bluetooth.
L2CAP
logical Link Control and Adaptation Protocol — используется для мультиплексирования локальных соединений между двумя устройствами, использующими различные протоколы более высокого уровня. Позволяет фрагментировать и пересобирать пакеты.
SDP
Service Discovery Protocol — позволяет обнаруживать услуги, предоставляемые другими устройствами, и определять их параметры.
RFCOMM
Radio Frequency Communications — протокол замены кабеля, создаёт виртуальный последовательный поток данных и эмулирует управляющие сигналы RS-232.
BNEP
Bluetooth Network Encapsulation Protocol — используется для передачи данных из других стеков протоколов через канал L2CAP. Применяется для передачи IP-пакетов в профиле Personal Area Networking.
AVCTP
Audio/Video Control Transport Protocol — используется в профиле Audio/Video Remote Control для передачи команд по каналу L2CAP.
AVDTP
Audio/Video Distribution Transport Protocol — используется в профиле Advanced Audio Distribution для передачи стереозвука по каналу L2CAP.
TCS
Telephony Control Protocol — Binary — протокол, определяющий сигналы управления вызовом для установления голосовых соединений и соединений для передачи данных между устройствами Bluetooth. Используется только в профиле Cordless Telephony.Заимствованные протоколы включают в себя: Point-to-Point Protocol (PPP), TCP/IP, UDP, Object Exchange Protocol (OBEX), Wireless Application Environment (WAE), Wireless Application Protocol (WAP).

Профили Bluetooth
Профиль — набор функций или возможностей, доступных для определённого устройства Bluetooth. Для совместной работы Bluetooth-устройств необходимо, чтобы все они поддерживали общий профиль.
Нижеуказанные профили определены и одобрены группой разработки Bluetooth SIG:

Advanced Audio Distribution Profile (A2DP) — разработан для передачи двухканального стерео аудиопотока, например, музыки, к беспроводной гарнитуре или любому другому устройству. Профиль полностью поддерживает низкокомпрессированный кодек Sub_Band_Codec (SBC) и опционально поддерживает MPEG-1,2 аудио, MPEG-2,4 AAC и ATRAC, способен поддерживать кодеки, определённые производителем.
Audio/Video Remote Control Profile (AVRCP) — разработан для управления стандартными функциями телевизоров, Hi-Fi оборудования и прочего. То есть позволяет создавать устройства с функциями дистанционного управления. Может использоваться в связке с профилями A2DP или VDP.
Basic Imaging Profile (BIP) — разработан для пересылки изображений между устройствами и включает возможность изменения размера изображения и конвертирование в поддерживаемый формат принимающего устройства.
Basic Printing Profile (BPP) — позволяет пересылать текст, сообщения электронной почты, vCard и другие элементы на принтер. Профиль не требует от принтера специфических драйверов, что выгодно отличает его от HCRP.
Common ISDN Access Profile (CIP) — для доступа устройств к ISDN.
Cordless Telephony Profile (CTP) — профиль беспроводной телефонии.
Device ID Profile (DIP) — позволяет идентифицировать класс устройства, производителя, версию продукта.
Dial-up Networking Profile (DUN) — протокол предоставляет стандартный доступ к Интернету или другому телефонному сервису через Bluetooth. Базируется на SPP, включает в себя команды PPP и AT, определённые в спецификации ETSI 07.07.
Fax Profile (FAX) — предоставляет интерфейс между мобильным или стационарным телефоном и ПК, на котором установлено программное обеспечение для факсов. Поддерживает набор AT-команд в стиле ITU T.31 и/или ITU T.32. Голосовой звонок или передача данных профилем не поддерживается.
File Transfer Profile (FTP_profile) — обеспечивает доступ к файловой системе устройства. Включает стандартный набор команд FTP, позволяющий получать список каталогов, изменения каталогов, получать, передавать и удалять файлы. В качестве транспорта используется OBEX, базируется на GOEP.
General Audio/Video Distribution Profile (GAVDP) — база для A2DP и VDP.
Generic Access Profile (GAP) — база для всех остальных профилей.
Generic Object Exchange Profile (GOEP) — база для других профилей передачи данных, базируется на OBEX.
Hard Copy Cable Replacement Profile (HCRP) — предоставляет простую альтернативу кабельного соединения между устройством и принтером. Минус профиля в том, что для принтера необходимы специфичные драйвера, что делает профиль неуниверсальным.
Hands-Free Profile (HFP) — используется для соединения беспроводной гарнитуры и телефона, передаёт монозвук в одном канале.
Human Interface Device Profile (HID) — обеспечивает поддержку устройств с HID (Human Interface Device), таких как мыши, джойстики, клавиатуры и проч. Использует медленный канал, работает на пониженной мощности.
Headset Profile (HSP) — используется для соединения беспроводной гарнитуры (Headset) и телефона. Поддерживает минимальный набор AT-команд спецификации GSM 07.07 для обеспечения возможности совершать звонки, отвечать на звонки, завершать звонок, настраивать громкость. Через профиль Headset, при наличии Bluetooth 1.2 и выше, можно выводить на гарнитуру всё звуковое сопровождение работы телефона. Например, прослушивать на гарнитуре все сигналы подтверждения операций, mp3-музыку из плеера, мелодии звонка, звуковой ряд видеороликов. Гарнитуры, поддерживающие такой профиль, имеют возможность передачи стереозвука, в отличие от моделей, которые поддерживают только профиль Hands-Free.
Intercom Profile (ICP) — обеспечивает голосовые звонки между Bluetooth-совместимыми устройствами.
LAN Access Profile (LAP) — обеспечивает доступ Bluetooth-устройствам к вычислительным сетям LAN, WAN или Интернет посредством другого Bluetooth-устройства, которое имеет физическое подключение к этим сетям. Bluetooth-устройство использует PPP поверх RFCOMM для установки соединения. LAP также допускает создание ad-hoc Bluetooth-сетей.
Object Push Profile (OPP) — базовый профиль для пересылки «объектов», таких как изображения, виртуальные визитные карточки и др. Передачу данных инициирует отправляющее устройство (клиент), а не приёмное (сервер).
Personal Area Networking Profile (PAN) — позволяет использовать протокол Bluetooth Network Encapsulation в качестве транспорта через Bluetooth-соединение.
Phone Book Access Profile (PBAP) — позволяет обмениваться записями телефонных книг между устройствами.
Serial Port Profile (SPP) — базируется на спецификации ETSI TS07.10 и использует протокол RFCOMM. Профиль эмулирует последовательный порт, предоставляя возможность замены стандартного RS-232 беспроводным соединением. Является базовым для профилей DUN, FAX, HSP и AVRCP.
Service Discovery Application Profile (SDAP) — используется для предоставления информации о профилях, которые использует устройство-сервер.
SIM Access Profile (SAP, SIM) — позволяет получить доступ к SIM-карте телефона, что позволяет использовать одну SIM-карту для нескольких устройств.
Synchronisation Profile (SYNCH) — позволяет синхронизировать персональные данные (PIM). Профиль заимствован из спецификации инфракрасной связи и адаптирован группой Bluetooth SIG.
Video Distribution Profile (VDP) — позволяет передавать потоковое видео. Поддерживает H.263, стандарты MPEG-4 Visual Simple Profile, H.263 profiles 3, profile 8 поддерживаются опционально и не содержатся в спецификации.
Wireless Application Protocol Bearer (WAPB) — протокол для организации P-to-P (Point-to-Point) соединения через Bluetooth.

Безопасность
В июне 2006 года Авишай Вул и Янив Шакед опубликовали статью, содержащую подробное описание атаки на устройства Bluetooth. Материал содержал описание как активной, так и пассивной атаки, позволяющей заполучить PIN-код устройства и в дальнейшем осуществить соединение с данным устройством. Пассивная атака позволяет соответствующе экипированному злоумышленнику «подслушать» (sniffing) процесс инициализации соединения и в дальнейшем использовать полученные в результате прослушки и анализа данные для установления соединения (spoofing). Естественно, для проведения данной атаки злоумышленнику нужно находиться в непосредственной близости и непосредственно в момент установления связи. Это не всегда возможно. Поэтому родилась идея активной атаки. Была обнаружена возможность отправки особого сообщения в определённый момент, позволяющего начать процесс инициализации с устройством злоумышленника. Обе процедуры взлома достаточно сложны и включают несколько этапов, основной из которых — сбор пакетов данных и их анализ. Сами атаки основаны на уязвимостях в механизме аутентификации и создания ключа-шифра между двумя устройствами.

Инициализация bluetooth-соединения
Инициализацией bluetooth-соединения принято называть процесс установки связи. Её можно разделить на три этапа:

генерация ключа Kinit,
генерация ключа связи (он носит название link key и обозначается, как Kab),
аутентификация.Первые два пункта входят в так называемую процедуру паринга.
Паринг (pairing), или сопряжение, — процесс связи двух (или более) устройств с целью создания общего секретного значения Kinit, которое они будут в дальнейшем использовать при общении. В некоторых переводах официальных документов по bluetooth можно также встретить термин «подгонка пары». Перед началом процедуры сопряжения на обеих сторонах необходимо ввести PIN-код.
Kinit формируется по алгоритму E22, который оперирует следующими величинами:

BD_ADDR — уникальный MAC-адрес BT-устройства длиной 48 бит;
PIN-код и его длина;
IN_RAND — случайная 128-битная величина.Для создания ключа связи Kab устройства обмениваются 128-битными словами LK_RAND(A) и LK_RAND(B), генерируемыми случайным образом. Далее следует побитовый XOR с ключом инициализации Kinit. И снова обмен полученным значением. Затем следует вычисление ключа по алгоритму E21.
Для этого необходимы величины:

BD_ADDR
128-битный LK_RAND (каждое устройство хранит своё и полученное от другого устройства значения)На данном этапе pairing заканчивается и начинается последний этап инициализации bluetooth — Mutual authentication, или взаимная аутентификация. Основана она на схеме «запрос-ответ». Одно из устройств становится верификатором, генерирует случайную величину AU_RAND(A) и посылает его соседнему устройству (в открытом виде), называемому предъявителем. Как только предъявитель получает это «слово», начинается вычисление величины SRES по алгоритму E1, и она отправляется верификатору. Соседнее устройство производит аналогичные вычисления и проверяет ответ предъявителя. Если SRES совпали, то устройства меняются ролямии процесс повторяется заново.
E1-алгоритм оперирует такими величинами:

Случайно созданное AU_RAND
link key Kab
Свой собственный BD_ADDR

Атака на сопряжение
Если злоумышленнику удалось прослушать эфир и во время процедуры сопряжения он перехватил и сохранил все сообщения, то далее найти PIN можно используя перебор.
Первым, кто заметил эту уязвимость, был англичанин Олли Вайтхауз (Ollie Whitehouse) в апреле 2004 года. Он первым предложил перехватить сообщения во время сопряжения и попытаться вычислить PIN методом перебора, используя полученную информацию. Тем не менее, метод имеет один существенный недостаток: атаку возможно провести только в случае, если удалось подслушать все аутентификационные данные. Другими словами, если злоумышленник находился вне эфира во время начала сопряжения или же упустил какую-то величину, то он не имеет возможности продолжить атаку.

Атака на пересопряжение
Вулу и Шакеду удалось найти решение трудностей, связанных с атакой Вайтхауза. Был разработан второй тип атаки. Если процесс сопряжения уже начат и данные упущены, провести атаку невозможно. Но если устройства уже успели связаться, сохранили ключ Kab и приступили к взаимной аутентификации, можно заставить устройства заново инициировать процесс сопряжения чтобы провести вышеописанную атаку на сопряжение.
Данная атака требует отправки нужных сообщений в нужный момент времени. Стандартные устройства, доступные в продаже, не подойдут для этих целей.
Использовав любой из этих методов, злоумышленник может приступить к базовой атаке на сопряжение. Таким образом, имея в арсенале эти две атаки, злоумышленник может беспрепятственно похитить PIN-код. Далее имея PIN-код он сможет установить соединение с любым из этих устройств. И стоит учесть, что в большинстве устройств безопасность на уровне служб, доступных через bluetooth, не обеспечивается на должном уровне. Большинство разработчиков делает ставку именно на безопасность установления сопряжения. Поэтому последствия действий злоумышленника могут быть различными: от кражи записной книжки телефона до установления исходящего вызова с телефона жертвы и использования его как прослушивающего устройства.

Оценка времени подбора PIN-кода
В протоколе Bluetooth активно используются алгоритмы E22, E21, E1, основанные на шифре SAFER+. Брюс Шнайер подтвердил, что уязвимость относится к критическим. Подбор PIN на практике прекрасно работает и может быть произведен в реальном времени. Ниже приведены результаты, полученные на Pentium IV HT на 3 ГГц:

Конкретные реализации вышеописанных атак могут работать с различной скоростью. Способов оптимизации множество: особые настройки компилятора, различные реализации циклов, условий и арифметических операций. Авишай Вул и Янив Шакед нашли способ значительно сократить время перебора PIN-кода.
Увеличение длины PIN-кода не является панацеей. Только сопряжение устройств в безопасном месте может частично защитить от описанных атак. Пример — bluetooth-гарнитура или автомобильный handsfree. Инициализация связи (при включении) с данными устройствами может происходить многократно в течение дня, и не всегда у пользователя есть возможность находиться при этом в защищённом месте.

Применение
Радиус работы устройств BT2 не превышает 16 метров, для BT1 — до 100 м (класс А). Эти числа декларируются стандартом для прямой видимости, в реальности не стоит ожидать работы на расстоянии более 10—20 м. Такого дальнодействия недостаточно для эффективного применения атак на практике. Поэтому, ещё до детальной проработки алгоритмов атаки, на Defcon-2004 публике была представлена антенна-винтовка BlueSniper, разработанная Джонном Херингтоном (John Herington). Устройство подключается к портативному устройству — ноутбуку/КПК и имеет достаточную направленность и мощность (эффективная работа до 1,5 км).

Сосуществование с другими протоколами
Частая смена рабочего канала FHSS в широком диапазоне частот дает шанс на сосуществование с другими протоколами. С введением адаптивной AFH ситуация немного улучшилась.

Отладка и сертификация
Отладка и контроль соответствия стандарту осложняется активными соседями по диапазону (например, Wi-Fi).
Существуют решения, позволяющие декодировать и отслеживать все соединения одновременно во всех 79 каналах Bluetooth.

См. также
IEEE 802.15.4
Стек Bluetooth
Блюджекинг
UWB

Примечания
Литература
Сергей Асмаков. Интерфейс Bluetooth: разберемся с нюансами // КомпьютерПресс : журнал. — 2013. — 12 марта (№ 3 (279)). — С. 34—36. — ISSN 0868-6157.

Ссылки
Bluetooth tutorial
Спецификации (англ.)
Bluetooth-безопасность
Bluetooth 2.0/EDR — хорошо доделанное старое
Yaniv Shaked, Avishai Wool. Cracking the Bluetooth PIN
NFC Forum