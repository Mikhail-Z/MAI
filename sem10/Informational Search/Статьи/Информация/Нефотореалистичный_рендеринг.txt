Нефотореалистичный рендеринг — область компьютерной графики, посвящённая созданию методов имитации большого разнообразия выразительных стилей в цифровом искусстве. В отличие от традиционной компьютерной графики, сфокусированной на фотореализме, НФР основывается на других художественных стилях, таких как графика, живопись, техническая иллюстрация и мультипликационный стиль.

Введение
Существует множество различных методов решения задач НФР.
Рассмотрим подробно 4:

Генетическое рисование: Поиск выделяющихся объектов на изображении;
Рисование с помощью релаксации;
Стилизация и абстракция фотографий;
Построение изображений с помощью кривых;

Техники НФР
Генетическое рисование: Поиск выделяющихся объектов на изображении
Цель данного алгоритма — создание изображений в стиле impasto (наложение красок густым слоем).

На первом этапе работы алгоритма определяется степень значимости каждого элемента исходного изображения, построить карту значимости и в соответствии с ней определять детализацию каждого элемента на результирующем изображении. Однако определение ключевых деталей на изображении является субъективным процессом. Поэтому предлагается использовать классификатор, который натренировывается вручную на определение разных классов выделяющихся деталей изображения (углов, границ и т. д.). Такой подход позволяет определять уровень детализации без интерактивного вмешательства пользователя и варьировать стиль с штриха в зависимости от класса артефакта (выделяющейся детали).Построение результирующего изображения.
Уровень детализации в картине художника тесно связан с картой значимостей исходного изображения. С этой точки зрения, оптимальным критерием для искомой картины является измерение силы этого соответствия. Таким образом процесс построения изображения рассматривается как поиск оптимальной картины по этому определению. Стратегия поиска основана на генетическом алгоритме. Алгоритм принимает на вход исходное изображение I; картины порождённые I будут элементами пространства поиска. Сначала инициализируется фиксированный размер набора объектов. Каждый объект — один элемент пространства поиска, представленный как упорядоченный список штрихов.
Картина формируется поиском-преобразованием и композицией списка мазков кисти, представленных сплайновыми кривыми. Толщина кисти устанавливается обратно пропорциональной значимости, которая берётся как среднее по всем контрольным точкам. Цвет мазка един и задаётся как среднее значение по всем пикселам, захваченным областью мазка. Первыми накладываются мазки с наименьшей значимостью.
Генетический Алгоритм симулирует процесс естественного отбора посредством отбора последовательных поколений объектов через перекрёстную, пропорционально-пригодную репродукцию и мутацию. В нашем случае геномы объектов — упорядоченные списки мазков. Итерации ГА повторяются до тех пор, пока преимущества достигнутые над предыдущими несколькими поколениями минимальны.

Рисование с помощью релаксации
Основная идея алгоритма построения изображения методом релаксации состоит в том, что картина формулируется как проблема снижения энергии.
Имея функцию энергии 
  
    
      
        E
        (
        P
        )
      
    
    {\displaystyle E(P)}
  ,мы ищем картину 
  
    
      
        
          P
          
            ∗
          
        
      
    
    {\displaystyle P^{*}}
   с наименьшей энергией:

  
    
      
        
          P
          
            ∗
          
        
        =
        a
        r
        g
        
          min
          
            P
            ∈
            
              
                P
              
            
          
        
        E
        (
        P
        )
      
    
    {\displaystyle P^{*}=arg\min _{P\in {\mathfrak {P}}}E(P)}
  
где 
  
    
      
        
          
            P
          
        
      
    
    {\displaystyle {\mathfrak {P}}}
   — пространство всех картин.
Картина определяется как упорядоченный набор цветных штрихов вместе с закрашенной или текстурной канвой. Штрих кисти — толстая кривая, заданная списком контрольных точек, цветом и толщиной. Картина строится упорядоченным нанесением мазков на канву, представленных толстыми бикубическими сплайнами, в порядке их создания.
Энергетическая функция создаётся как комбинация различных функций, позволяющих выразить желаемый результат картины, и их относительной значимости (веса функции).
Каждая функция соответствует различным стилям рисования. Такая формулировка позволяет как можно более интуитивно выразить создание разнообразных стилей рисования, когда мы описываем желаемые особенности картины.

  
    
      
        E
        (
        P
        )
        =
        
          E
          
            a
            p
            p
          
        
        (
        P
        )
        +
        
          E
          
            a
            r
            e
            a
          
        
        (
        P
        )
        +
        
          E
          
            n
            s
            t
            r
          
        
        (
        P
        )
        +
        
          E
          
            c
            o
            v
          
        
      
    
    {\displaystyle E(P)=E_{app}(P)+E_{area}(P)+E_{nstr}(P)+E_{cov}}
  

  
    
      
        
          E
          
            a
            p
            p
          
        
        (
        P
        )
        =
        
          ∑
          
            (
            x
            ,
            y
            )
            ∈
            X
          
        
        
          w
          
            a
            p
            p
          
        
        (
        x
        ,
        y
        )
        
          |
        
        
          |
        
        P
        (
        x
        ,
        y
        )
        −
        G
        (
        x
        ,
        y
        )
        
          |
        
        
          |
        
      
    
    {\displaystyle E_{app}(P)=\sum _{(x,y)\in X}w_{app}(x,y)||P(x,y)-G(x,y)||}
  

  
    
      
        
          E
          
            a
            r
            e
            a
          
        
        (
        P
        )
        =
        
          w
          
            a
            r
            e
            a
          
        
        
          ∑
          
            S
            ∈
            P
          
        
        A
        r
        e
        a
        (
        S
        )
      
    
    {\displaystyle E_{area}(P)=w_{area}\sum _{S\in P}Area(S)}
  

  
    
      
        
          E
          
            n
            s
            t
            r
          
        
        (
        P
        )
        =
        
          w
          
            n
            s
            t
            r
          
        
        ∗
        (
        n
        u
        m
        b
        e
        r
         
        o
        f
         
        s
        t
        r
        o
        k
        e
        s
         
        i
        n
         
        P
        )
      
    
    {\displaystyle E_{nstr}(P)=w_{nstr}*(number~of~strokes~in~P)}
  

  
    
      
        
          E
          
            c
            o
            v
          
        
        (
        P
        )
        =
        
          w
          
            n
            s
            t
            r
          
        
        ∗
        (
        n
        u
        m
        b
        e
        r
         
        o
        f
         
        e
        m
        p
        t
        y
         
        p
        i
        x
        e
        l
        s
         
        i
        n
         
        P
        )
      
    
    {\displaystyle E_{cov}(P)=w_{nstr}*(number~of~empty~pixels~in~P)}
  

  
    
      
        
          E
          
            a
            p
            p
          
        
      
    
    {\displaystyle E_{app}}
   рассчитывает попиксельную разницу между рисунком и исходным изображением;

  
    
      
        
          E
          
            n
            s
            t
            r
          
        
      
    
    {\displaystyle E_{nstr}}
   контролирует размер кисти;

  
    
      
        
          E
          
            a
            r
            e
            a
          
        
      
    
    {\displaystyle E_{area}}
   рассчитывает суммарную площадь поверхности, покрытой мазками кисти;

  
    
      
        
          E
          
            c
            o
            v
          
        
      
    
    {\displaystyle E_{cov}}
   контролирует степень закрашенности канвы.
Таким образом, есть возможность «рисовать» в различных стилях путём варьирования весов, определяющих вклад той или иной составляющей энергетической функции. Однако невозможно напрямую построить картину с наименьшей энергией и необходимо придумать способ заполнения пространства поиска.

Стилизация и абстракция фотографий
Это интерактивный НФР алгоритм для рендеринга изображений в line-drawing стиле с использованием жирных линий и однотонного заполнения областей. Цель — построение изображения с выделенными в соответствии с особенностями человеческого восприятия объектами.

Выделение границ (усовершенствованный Canny);
Сегментация;
Сегментация изображения с разными разрешениями для построения иерархии;
Вычисление значимых областей с помощью eye-detector’а;
Последовательная «сборка» результирующего изображения. Уровень детализации прямо пропорционально зависит от степени значимости объекта на изображении, и заполнение однородных областей происходит в соответствии с иерархией, полученной на этапе сегментации изображения при разных значениях разрешения. Границы между однородными областями и границы, полученные с помощью Edge Detector’a сглаживаются.

Построение изображений с помощью кривых
Этот алгоритм представляет классический подход к построению нефотореалистичных изображений.
Его суть заключается в следующем:

На вход алгоритма подаётся изображение и список размеров кисти (радиусов). Далее алгоритм рисует серии слоёв для каждого значения радиуса соответственно (от самого большого до самого маленького).
Изначально канва представляет собой однотонное изображение.
Для каждого слоя создаётся эталонное изображение путём размытия исходного, размытие представляется свёрткой с ядром Гаусса со стандартным отклонением 
  
    
      
        f
      
    
    {\displaystyle f}
   (
  
    
      
        f
      
    
    {\displaystyle f}
  -константа). Это изображение, которое мы пытаемся апроксимировать, рисуя кистью данного размера.
Каждая кисть покрывает только те детали, которые по крайней мере так же велики, как кисть. Кроме того, кистью покрываются только те участки изображения, которые отличаются по цвету от эталонного; те же, чьё отличие лежит внутри заданного порога, не изменяются.
Подход к заполнению каждого слоя — обход сетки в произвольном порядке и просмотр соседей каждого узла.
Для создания кривых используются кубические B-сплайны с заданным цветом и толщиной. Каждый мазок рисуется переносом круглой маски по изгибу сплайна.

Заключение
Было рассмотрено 4 разных подхода к построению нефотореалистичных изображений.

Построение изображений с помощью кривых является базовым алгоритмом и отличается своей простотой. Однако с его помощью невозможно получить большого разнообразия впечатляющих результатов.
Построение изображений методом релаксации позволяет получать различные результирующие изображения путём варьирования вкладов функций, составляющих функцию энергии. Однако он имеет некоторые сложности в построении.
Генетический алгоритм позволяет получать неплохие результаты, учитывающие значимость отдельных элементов изображения, без интерактивного вмешательства пользователя, однако он ресурсоёмкий и требует больших временных затрат на построение.
Стилизация и абстракция фотографий даёт впечатляющие результаты, однако достаточно специфичен и требует интерактивного вмешательства.

См. также
Цел-шейдеры

Ссылки
Painterly Rendering with Curved Brush Strokes of Multiple Sizes
Paint By Relaxation
Stylization and Abstraction of Photographs
Genetic Paint: A Search for Salient Paintings