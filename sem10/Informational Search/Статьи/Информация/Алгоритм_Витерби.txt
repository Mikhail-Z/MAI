Алгоритм Витерби — алгоритм поиска наиболее подходящего списка состояний (называемого путём Витерби), который в контексте цепей Маркова получает наиболее вероятную последовательность произошедших событий.
Является алгоритмом динамического программирования. Применяется в алгоритме свёрточного декодирования Витерби.
Алгоритм был предложен Эндрю Витерби в 1967 году как алгоритм декодирования свёрточного кода, передаваемого по сетям с наличием шума. Алгоритм получил широкое применение в декодировании свёрточных кодов мобильных телефонов стандартов GSM и CDMA, dial-up модемах и беспроводных сетях стандарта 802.11. Также он широко используется в распознавании речи, синтезе речи, компьютерной лингвистике и биоинформатике. К примеру, при распознавании речи звуковой сигнал воспринимается как последовательность событий и строка текста есть «скрытый смысл» акустического сигнала. Алгоритм Витерби находит наиболее вероятную строку текста по данному сигналу.
Алгоритм делает несколько предположений:

наблюдаемые и скрытые события должны быть последовательностью. Последовательность чаще всего упорядочена по времени.
две последовательности должны быть выровнены: каждое наблюдаемое событие должно соответствовать ровно одному скрытому событию
вычисление наиболее вероятной скрытой последовательности до момента t должно зависеть только от наблюдаемого события в момент времени t, и наиболее вероятной последовательности до момента t − 1.

Алгоритм
Пусть у нас есть скрытая марковская модель с пространством состояний 
  
    
      
        S
      
    
    {\displaystyle S}
  , начальными вероятностями 
  
    
      
        
          π
          
            i
          
        
      
    
    {\displaystyle \pi _{i}}
   нахождения в состоянии 
  
    
      
        i
      
    
    {\displaystyle i}
   и вероятностями 
  
    
      
        
          a
          
            i
            ,
            j
          
        
      
    
    {\displaystyle a_{i,j}}
   перехода из состояния 
  
    
      
        i
      
    
    {\displaystyle i}
   в состояние 
  
    
      
        j
      
    
    {\displaystyle j}
  . Пусть мы наблюдаем на выходе 
  
    
      
        
          y
          
            1
          
        
        ,
        …
        ,
        
          y
          
            T
          
        
      
    
    {\displaystyle y_{1},\dots ,y_{T}}
  . Тогда наиболее вероятная последовательность состояний 
  
    
      
        
          x
          
            1
          
        
        ,
        …
        ,
        
          x
          
            T
          
        
      
    
    {\displaystyle x_{1},\dots ,x_{T}}
   задается рекуррентными соотношениями:

  
    
      
        
          
            
              
                
                  V
                  
                    1
                    ,
                    k
                  
                
              
              
                =
              
              
                
                  P
                
                
                  
                    (
                  
                
                
                  y
                  
                    1
                  
                
                 
                
                  |
                
                 
                k
                
                  
                    )
                  
                
                ⋅
                
                  π
                  
                    k
                  
                
              
            
            
              
                
                  V
                  
                    t
                    ,
                    k
                  
                
              
              
                =
              
              
                
                  P
                
                
                  
                    (
                  
                
                
                  y
                  
                    t
                  
                
                 
                
                  |
                
                 
                k
                
                  
                    )
                  
                
                ⋅
                
                  max
                  
                    x
                    ∈
                    S
                  
                
                
                  (
                  
                    
                      a
                      
                        x
                        ,
                        k
                      
                    
                    ⋅
                    
                      V
                      
                        t
                        −
                        1
                        ,
                        x
                      
                    
                  
                  )
                
              
            
          
        
      
    
    {\displaystyle {\begin{array}{rcl}V_{1,k}&=&\mathrm {P} {\big (}y_{1}\ |\ k{\big )}\cdot \pi _{k}\\V_{t,k}&=&\mathrm {P} {\big (}y_{t}\ |\ k{\big )}\cdot \max \limits _{x\in S}\left(a_{x,k}\cdot V_{t-1,x}\right)\end{array}}}
  Здесь 
  
    
      
        
          V
          
            t
            ,
            k
          
        
      
    
    {\displaystyle V_{t,k}}
   — это вероятность наиболее вероятной последовательности состояний, ответственная за появление первых 
  
    
      
        t
      
    
    {\displaystyle t}
   наблюдаемых символов, завершающаяся в состоянии 
  
    
      
        k
      
    
    {\displaystyle k}
  . Путь Витерби может быть найден при помощи указателей, запоминающих, какое состояние 
  
    
      
        x
      
    
    {\displaystyle x}
   появлялось во втором уравнении. Пусть 
  
    
      
        
          P
          t
          r
        
        (
        k
        ,
        t
        )
      
    
    {\displaystyle \mathrm {Ptr} (k,t)}
   — функция, которая возвращает значение 
  
    
      
        x
      
    
    {\displaystyle x}
  , использованное для подсчета 
  
    
      
        
          V
          
            t
            ,
            k
          
        
      
    
    {\displaystyle V_{t,k}}
  , если 
  
    
      
        t
        >
        1
      
    
    {\displaystyle t>1}
  , или 
  
    
      
        k
      
    
    {\displaystyle k}
   если 
  
    
      
        t
        =
        1
      
    
    {\displaystyle t=1}
  . Тогда

  
    
      
        
          
            
              
                
                  x
                  
                    T
                  
                
              
              
                =
              
              
                arg
                ⁡
                
                  max
                  
                    x
                    ∈
                    S
                  
                
                (
                
                  V
                  
                    T
                    ,
                    x
                  
                
                )
              
            
            
              
                
                  x
                  
                    t
                    −
                    1
                  
                
              
              
                =
              
              
                
                  P
                  t
                  r
                
                (
                
                  x
                  
                    t
                  
                
                ,
                t
                )
              
            
          
        
      
    
    {\displaystyle {\begin{array}{rcl}x_{T}&=&\arg \max \limits _{x\in S}(V_{T,x})\\x_{t-1}&=&\mathrm {Ptr} (x_{t},t)\end{array}}}
  Здесь мы используем стандартное определение arg max.
Сложность этого алгоритма равна 
  
    
      
        O
        (
        T
        ×
        
          
            |
            
              S
            
            |
          
          
            2
          
        
        )
      
    
    {\displaystyle O(T\times \left|{S}\right|^{2})}
  .

См. также
EM-алгоритм
Скрытая марковская модель


== Примечания ==