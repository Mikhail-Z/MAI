AACS (Advanced Access Content System; с англ. — «улучшенная система доступа к содержимому») — стандарт распространения информации и защиты авторских прав, назначение которого — ограничение доступа и копирования оптических дисков следующего поколения и DVD. Спецификация была опубликована в апреле 2005 года, и стандарт был адаптирован для ограничения доступа к HD DVD и Blu-ray Disc (BD). Стандарт разработан AACS LA (AACS Licensing Administrator), консорциумом, включающим в себя Disney, Intel, Microsoft, Panasonic, Warner Bros., IBM, Toshiba и Sony. AACS работает на основании временного соглашения, так как окончательная спецификация (включающая предоставление возможности легального копирования) ещё не принята. С момента появления в устройствах в 2006 году большинство ключей расшифрования было извлечено из слабо защищённых проигрывателей и опубликовано в интернете.

Обзор
Шифрование
AACS использует криптографию для контроля над использованием цифрового носителя данных. Содержимое зашифровывается с использованием одного или более титульных ключей (Title Key — ключ, ассоциированный с определённым произведением, например, с кинофильмом), используя шифр AES. Ключ получают из комбинации ключа носителя данных (Media Key), закодированного в блоке ключей (Media Key Block), и идентификатора тома (Volume ID) — например, физического серийного номера, встроенного в диск перед записью.
Принципиальное различие между AACS и CSS, системой защиты, используемой на DVD, заключается в том, как организованы ключи расшифрования.
При использовании CSS всем проигрывателям одной модели предоставлен один и тот же общий ключ расшифрования. Данные зашифрованы специфичным титульным ключом, который, в свою очередь, зашифрован ключом модели. Таким образом, каждый диск содержит набор из нескольких сотен зашифрованных ключей, по одному для каждой лицензированной модели проигрывателя.
В принципе, этот подход позволяет лицензиару «отозвать» любую модель проигрывателя (запретить ему проигрывать выходящий впоследствии контент) посредством прекращения шифрования титульных ключей ключом данной модели проигрывателя. На практике, однако, отключение всех проигрывателей определённой модели — дорогостоящая операция, так как многие пользователи потеряют возможность воспроизведения. Более того, использование общих ключей на многих плеерах делает компрометацию ключа значительно более вероятным, что было показано рядом компрометаций в середине 90-х.
При подходе AACS каждый индивидуальный проигрыватель снабжается уникальным набором ключей расшифрования, использующихся по схеме широковещательного шифрования. Этот подход позволяет лицензиару отзывать индивидуальные проигрыватели, или более точно — ключи дешифрования, связанные с этими проигрывателями. Таким образом, если ключ определённого проигрывателя скомпрометирован и опубликован, AACS LA может просто аннулировать этот ключ, делая его бесполезным для расшифровки новых произведений.
Также AACS имеет систему отслеживания утечек. Если взломщик пытается сохранить скомпрометированный ключ в секрете (публикуя только расшифрованные титульные ключи), тем не менее, он может быть отслежен. Стандарт допускает, что определённая часть фильма может иметь несколько версий и эти версии могут быть зашифрованы различными ключами для того, чтобы определённые проигрыватели смогли расшифровать только определённую версию каждой части. Посредством встраивания цифровых водяных знаков в различные версии и анализа того, какие секции фильма опубликовал взломщик, скомпрометированные ключи могут быть, в конце концов, идентифицированы и аннулированы (это свойство называется последовательными ключами в спецификации стандарта AACS).

Идентификаторы тома
Идентификаторы тома (VolumeIDs) — уникальные серийные номера или идентификаторы, сохраняемые на диске с помощью особых устройств перед записью. Они не могут быть продублированы на записываемых дисках пользователем. Их смысл — в предотвращении побитового копирования, так как идентификатор тома необходим (но не достаточен) для расшифрования. На Blu-ray-дисках идентификатор тома хранится в метке Blu-ray.Чтобы прочитать идентификатор тома, требуется криптографический сертификат, подписанный AACS LA — частный ключ хоста (Private Host Key). Однако пираты заявляют, что обошли эту защиту, модифицируя встроенное ПО на проигрывателе HD DVD.

Процесс расшифровывания
Для просмотра фильма проигрыватель должен сперва расшифровать содержимое диска. На диске содержится 4 элемента — блок ключа носителя (Media Key Block, MKB), идентификатор тома (VolumeID), зашифрованные ключи наименования (Title Keys) и зашифрованное содержимое. MKB зашифрован схемой дерева с вычитанием поднаборов (Subset Difference Tree). В сущности, набор ключей расположен в дереве так, что любой ключ может быть использован для нахождения любого другого ключа, кроме родительских. Таким образом, чтобы аннулировать данный ключ устройства, MKB должен быть зашифрован с помощью его родительского ключа. Если MKB расшифрован, он предоставляет ключ носителя, или KM (Media Key). KM комбинируется с идентификатором тома (который программа может получить, если присутствует криптографический сертификат, как написано выше) в одной схеме путём шифрования (AES-G), чтобы получить уникальный ключ тома (Kvu). Kvu используется для расшифровывания ключей наименования, которые используется для расшифровывания контента.

Закупорка аналоговой дыры
AACS-совместимые проигрыватели должны следовать нормам, касающимся аналоговых выходов. Это устанавливается флагом, называемым Image Constraint Token (Признак ограничения изображения, ICT), который ограничивает разрешение для аналоговых выходов до 960*540. Полное разрешение 1920*1080 ограничивается для выходов HDMI или DVI, которые поддерживают HDCP. Решение об установке флага ограничения вывода («down-convert») принимает сторона, предоставляющая информацию. Warner Pictures — сторонник ICT, и ожидается, что Paramount и Universal также будут использовать урезание изображения. Нормативы AACS требуют, что если в любом продукте используется ICT, производитель должен явно сообщать об этом на упаковке. Немецкий журнал «Der Spiegel» сообщил о неофициальном соглашении между киностудиями и производителями электроники не использовать ICT до 2010—2012. Однако некоторые диски были выпущены с использованием ICT.

Аудио водяные знаки
Возможно использование технологии нанесения водяных знаков компании Verance вместе с AACS. Студии могут записывать знаки в саундтрек театральных релизов. Если AACS-совместимый проигрыватель обнаруживает этот знак, это значит, диск является копией, сделанной в кинотеатре (возможно, «экранка»), что запрещает плееру воспроизводить диск. Этот знак изготавливается путём изменения звуковой дорожки согласно регулярной закономерности, передающей цифровой код. Эти изменения слишком незначительны, чтобы быть обнаруженными большинством людей. Другая разновидность этой системы может быть использована для препятствия воспроизведению дисков, скопированных посредством нелегального дублирования дисков с системой цифровых водяных знаков, купленных или арендованных потребителем. Эта разновидность — для домашнего просмотра — использует водяные знаки, которые отличаются от театральных тем, что допускаются на носителях, проданных потребителям.

Легальное копирование
Легальным копированием (Managed Copy) называется система, с помощью которой потребитель может изготавливать легальные копии фильмов или другого цифрового контента, защищённого AACS. Для этого необходим доступ устройства к удалённому серверу в интернете. Эти копии будут защищены DRM, так что бесконечное копирование невозможно (если, разумеется, явно не разрешено правообладателем). Для поставщиков информации предоставление покупателям этой возможности и для HD DVD, и для Blu-ray-стандарта является принудительным. Стандарты для Blu-ray были установлены позже, чем для HD DVD, после запроса HP.
Возможности легального копирования включают в себя (но не ограничены):

создание точной резервной копии на диске
создание копии в полном разрешении для хранения на сервере
создание уменьшенной версии для просмотра на переносимых устройствахЭто свойство не включено во временный стандарт, так что первые устройства не обладают этой возможностью. Оно станет частью окончательного стандарта AACS.

История
24 февраля 2001 года Дэлит Наор (Dalit Naor), Мони Наор (Moni Naor) и Джеф Лотспич (Jeff Lotspiech) опубликовали документ, озаглавленный «Схемы аннулирования и отслеживания для приёмников без запоминания состояния» (Revocation and Tracing Schemes for Stateless Receivers), в котором они описали широковещательную схему шифрования, использующую конструкцию деревьев с вычитанием поднаборов Наора-Наора-Лотспича (Naor-Naor-Lotspiech subset-difference trees). Этот документ заложил основу AACS.AACS LA была основана в 2004. Опубликование окончательного стандарта AACS было отложено, а затем снова отложено, когда важный член Blu-ray group высказал заинтересованность. По запросу Toshiba был выпущен временный стандарт, не включающий некоторые свойства, такие как легальное копирование. Окончательное соглашение было опубликовано 5 июня 2009 года.

Реализация с открытым исходным кодом
26 декабря 2006 года человек под ником «muslix64» выпустил рабочую утилиту с открытым исходным кодом, названную BackupHDDVD, пользуясь публично доступной спецификацией AACS. С правильным ключом она может быть использована для расшифровки зашифрованного контента. Вскоре была разработана аналогичная программа BackupBluRay, а также программа ClownDVD, аналогичная CloneDVD, но для Blu Ray. SlySoft заявила, что работает над CloneDVD HD версией (похожей на AnyDVD HD), поддерживающей Blu Ray.

Безопасность
Безопасность AACS была предметом многочисленных споров среди исследователей, людей, интересующихся HD видео и потребителей с самого момента его появления. Последовавший за CSS (механизмом контроля авторских прав, использующимся на DVD) AACS был нацелен на превосходство над CSS путём устранения недостатков, приведших к полному обходу CSS в 1999 году. Система AACS полагается на subset difference tree вместе с механизмом отзыва сертификатов, чтобы удостоверить безопасность контента — видео высокого разрешения — в случае компрометирования.
Даже до использования AACS исследователи безопасности сомневались в способности системы противостоять атакам.

Сравнение AACS и CSS
История атак
По итогам голосования читателей журнала IEEE Spectrum в 2005 году, AACS — одна из технологий, которые наиболее вероятно будут взломаны. Сомнения порождало сходство с предыдущими системами защиты (такие как CSS), которые потерпели неудачу и неспособность сохранить безопасность при атаках, которые включают компрометирование множества плееров. Йон Лех Йоханссен (Jon Lech Johansen), член команды, которая обошла CSS, сказал, что ожидает взлома AACS к концу 2006 — началу 2007 года.
В конце 2006 года эксперт по безопасности Peter Gutmann выпустил «Анализ расходов на систему защиты данных Windows Vista» — технический документ, который критикует реализацию различных систем защиты в Windows Vista.

Позднее Microsoft заявил, что документ содержит ряд фактических ошибок.
Хотя значительные усилия прилагались к тому, чтобы содержимое было зашифровано на всём пути от диска до монитора, в июле 2006 года было обнаружено, что точная копия любого кадра фильма может быть снята с определённых Blu-ray и HD DVD в некоторых проигрывателях с помощью функции Print Screen операционной системы Windows. Предполагалось, что, будучи автоматизированным, этот процесс поможет снять точную копию фильма, подобно копированию DVD, до взлома CSS, но на данный момент подобных копий не обнаружено. Эта ошибка была исправлена в последующих версиях программ.
Подобный подход не компрометирует само шифрование AACS, полагаясь на то, что официально лицензированный проигрыватель проводит расшифровку. Таким образом, выходные данные — не сжатое видео с диска, а распакованное видео. Это — пример аналоговой дыры.
И ключ диска и ключ, использованный для его расшифровки (названный «ключ обработки» в спецификации), были найдены с использованием отладчиков для исследования памяти запущенных программ воспроизведения HD DVD и Blu-ray. Хакеры заявляют, что обнаружили ключ устройства (используемый для вычисления ключа обработки) и частный ключ хоста (ключ, подписанный AACS LA для подтверждения установления связи между хостом и HD-приводом; необходим для чтения идентификатора тома). Вскоре после этого стали доступны первые незащищённые HD-фильмы. Ключ обработки был широко опубликован в интернете после своего нахождения, и AACS LA рассылала множество требований убрать ключ. Некоторые сайты, предоставляющие информацию, поставляемую пользователями, вроде Digg или Wikipedia, пытались убрать упоминания о ключе. Администрация Digg.com, в конце концов, перестала пытаться цензурировать сообщения, содержащие ключ.
Компания Cyberlink, выпускающая плеер PowerDVD, заявила, что их ПО не могло быть использовано как часть этого эксплойта.
Извлечение ключей AACS подчеркнуло неотъемлемую слабость любой системы DRM, позволяющей программным проигрывателям воспроизводить содержимое. Не важно, сколько уровней шифрования было применено, они не предоставляют истинной защиты, так как ключи, нужные для получения расшифрованной информации, должны находиться где-то в оперативной памяти, чтобы воспроизведение было возможно. Платформа PC не предлагает способа предотвращения просмотра памяти для обнаружения ключей, так как конфигурация PC всегда может быть эмулирована на виртуальной машине теоретически таким образом, что никакая запущенная внешняя программа не сможет обнаружить виртуализацию. Единственный способ надёжно предотвратить подобные атаки потребовал бы изменения платформы PC (см. Trusted Computing) на способную предоставить подобную защиту. Это потребовало бы от распространителей запрещения воспроизведения на машинах без доверительной технологии посредством непредоставления компаниям, выпускающим программные плееры для недоверительных ПК, нужных ключей расшифрования.
SlySoft выпустил AnyDVD HD, позволяющую воспроизводить HD DVD и Blu-ray на несовместимом с HDCP оборудовании. Фильмы могут быть расшифрованы «на лету» напрямую с диска или могут быть скопированы на другой носитель. AnyDVD HD также способен удалять нежелательные логотипы и трейлеры. SlySoft заявил, что AnyDVD HD использует несколько различных механизмов для деактивирования шифрования и не использует скомпрометированных ключей. Также было заявлено, что AACS обладает даже большим числом недостатков реализации, чем CSS, что делает его крайне уязвимым, но они не будут публиковать детали его реализации. Пользователи на Doom9 утверждают, что программа использует сертификат хоста плеера PowerDVD v6.5, но SlySoft утверждает, что программа не подвержена системе аннулирования AACS.

Хронология
26 декабря 2006 года пользователь под ником «muslix64» опубликовал рабочую утилиту, названную BackupHDDVD и её исходный код на форуме сайта Doom9. Она может быть использована для расшифровки AACS-защищённого контента, если известен ключ расшифровывания. muslix64 заявил, что нашёл ключ названия и ключ тома в основной памяти во время проигрывания HD DVD диска программным проигрывателем, и что найти их нетрудно.
2 января 2007 года muslix64 опубликовал новую версию программы с поддержкой ключа тома. 12 января 2007 другие участники форума подробно изложили, как найти другие ключи названия и тома, заявляя, что обнаружили ключи нескольких фильмов в RAM во время работы WinDVD. 
Около 13 января ключи были размещены на pastebin.com в форме загадки, которая решалась путём поиска терминов в поисковике Google. Переведя результат в шестнадцатеричный вид, можно было получить корректный код. Позднее в этот день первый взломанный HD DVD, Serenity, был загружен на частный торрент-трекер.
26 января AACS LA подтвердила, что ключи некоторых HD DVD были опубликованы без соответствующего разрешения.
15 января 2007 года был запущен сайт HDKeys.com, содержащий базу данных по ключам названия HD DVD. Он также содержит модифицированную копию программы BackupHDDVD, доступную для получения ключей онлайн (позднее убранную по жалобе DCMA).
11 февраля пользователь arnezami обнаружил и опубликовал ключ обработки AACS — 09 F9 11 02 9D 74 E3 5B D8 41 56 C5 63 56 88 C0

Этот ключ не является характерным для какого-либо устройства воспроизведения или наименования.
4 марта пользователь jx6bpm заявил, что обнаружил ключ плеера PowerDVD, и что он совпадает с ключом, используемым AnyDVD.
16 апреля 2007 консорциум AACS заявил об аннулировании ключей устройства, используемых и Cyberlink PowerDVD, и InterVideo WinDVD, и были выпущены патчи, включающие в себя новые ключи и улучшенную защиту ключей. Чтобы далее быть способными воспроизводить новый контент, пользователи были вынуждены «пропатчить» программы, что также укрепило безопасность проигрывателей.
Старые, скомпрометированные ключи всё ещё могут быть использованы для расшифровки старых дисков, но не более новых релизов, так как они будут зашифрованы новыми ключами. Несмотря на все аннулирования, в настоящее время диски могут быть расшифрованы с использованием MKB v7, v9 или v10, широко доступных в интернете.
23 мая 2007 года, за неделю до поступления дисков в розничную продажу, ключ обработки для следующей версии ключа блока данных был опубликован на странице комментариев в посте блога Freedom to Tinker.
В августе 2008 было обнаружено ещё 2 ключа расшифрования:

F1 90 A1 E8 17 8D 80 64 34 94 39 4F 80 31 D9 C8 — MKB v4,
7A 5F 8A 09 F8 33 F7 22 1B D4 1F A6 4C 9C 79 33 — MKB v6, v7, v8.В марте 2009 было обнаружено ещё 2 ключа расшифрования:

C8 72 94 CE 84 F9 CC EB 59 84 B5 47 EE C1 8D 66 — MKB v9,
45 2F 6E 40 3C DF 10 71 4E 41 DF AA 25 7D 31 3F — MKB v10

Обновления ключа блока данных
Спор о ключе дешифровки AACS
Спор о ключе дешифровки AACS возник в апреле 2007 года, когда Motion Picture Association of America (MPAA) и AACS LA начали отправлять письма с требованиями сайтам, опубликовавшим 128-битный (16-байтный) номер, представимый в шестнадцатеричном виде как 09 F9 11 02 9D 74 E3 5B D8 41 56 C5 63 56 88 C0 (зачастую называемый 09 F9), являющийся одним из криптографических ключей для HD DVD и Blu-ray. В сообщениях требовали немедленно убрать ключ и любые ссылки на него, цитируя положения US Digital Millennium Copyright Act (DMCA) против взлома данных.
В ответ на широкое распространение ключа в интернете AACS LA выпустила ряд заявлений в прессе, в котором благодарила сайты, выполнившие её требования, как действующие «дисциплинированно», и предупреждала, что к ситуации будут применены легальные технические средства.
Спор ещё более усилился в начале мая 2007 года, когда крупный новостной сайт Digg получил от DMCA сообщение с требованием прекратить работу, а затем удалил множество статей на эту тему и заблокировал пользователей, распространявших данную информацию. Это вызвало то, что некоторые описывают как цифровое восстание или кибер-бунт, в ходе которого пользователи стали намеренно публиковать ключ на Digg и в интернете совместно; такой тип реакции известен как Эффект Стрейзанд. AACS LA описала ситуацию как «новую интересную уловку».
Для распространения ключа пользователи Интернета создали «флаг свободы слова», в цветах которого были закодированы байты ключа.

Примечания
Ссылки
Официальный сайт AACS (англ.)
Спецификация AACS (англ.)
Члены AACS LA  (англ.)