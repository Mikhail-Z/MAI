Це́лостность сигна́лов (англ. Signal Integrity) — наличие достаточных для безошибочной передачи качественных характеристик электрического сигнала.

Общие сведения
Любой цифровой сигнал по своей сути является аналоговым, то есть представлен эпюрами напряжения (или тока) определенной формы. Очевидно, что форма аналогового сигнала может быть изменена из-за воздействия шумов, нелинейных искажений, перекрестных помех, отражений и так далее. При передаче сигналов на короткие (в смысле электрической длины) расстояния и при низкой информационной скорости указанные эффекты никак не сказываются на достоверности передаваемой и принимаемой информации. При увеличении скорости передачи, или увеличении длины тракта передачи (то есть при увеличении электрической длины) различные эффекты могут исказить сигнал до такой степени, что передаваемая информация будет принята с ошибками. Работу инженера по целостности сигналов можно разделить на два этапа. Первый — это анализ целостности сигналов, то есть выявление тех самых эффектов, которые приводят к искажению сигнала. Второй этап — это борьба с этими искажениями.

История
Для описания истории развития целостности сигналов как раздела радиотехники можно обратиться к хронологии предложенной Дугласом Бруксом:

1-я стадия. Вообще нет представлений о целостности сигналов, так как нет никаких проблем с передачей.
2-я стадия. Возникают проблемы с паразитными индуктивностями.
3-я стадия. Возникают проблемы, вызванные тем фактом, что сопротивление больше нельзя считать константой, а приходится учитывать его зависимость от частоты.
4-я стадия. Возникли проблемы связанные с критическими длинами (электрическими), которые стали так коротки, что чрезвычайно трудно решить проблемы, даже если они известны.

Теоретические основы
Фундаментальной наукой для специальности Целостность сигналов по большей части является теория электромагнетизма. Теория электромагнетизма опирается на уравнения Максвелла, записанные им в 1873 году. При изучении целостности сигналов чаще всего пользуются интуитивно понятной дифференциальной формой уравнений. Однако, при необходимости, может быть использована и интегральная форма уравнений.

  
    
      
        ∇
        ×
        
          
            E
            →
          
        
        +
        
          
            
              ∂
              
                
                  B
                  →
                
              
            
            
              ∂
              
                t
              
            
          
        
        =
        0
        ,
        
        
        
        
        
        
        
        
        
        
      
    
    {\displaystyle \nabla \times {\overrightarrow {E}}+{\frac {\partial {\overrightarrow {B}}}{\partial {t}}}=0,\;\;\;\;\;\;\;\;\;\;}
    Закон Фарадея

  
    
      
        ∇
        ×
        
          
            H
            →
          
        
        =
        
          
            J
            →
          
        
        +
        
          
            
              ∂
              
                
                  D
                  →
                
              
            
            
              ∂
              
                t
              
            
          
        
        ,
        
        
        
        
        
        
        
        
        
      
    
    {\displaystyle \nabla \times {\overrightarrow {H}}={\overrightarrow {J}}+{\frac {\partial {\overrightarrow {D}}}{\partial {t}}},\;\;\;\;\;\;\;\;\;}
   Закон Ампера

  
    
      
        ∇
        ⋅
        
          
            D
            →
          
        
        =
        ρ
        ,
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
      
    
    {\displaystyle \nabla \cdot {\overrightarrow {D}}=\rho ,\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;}
     Закон Гаусса

  
    
      
        ∇
        ⋅
        
          
            B
            →
          
        
        =
        0
        ,
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
      
    
    {\displaystyle \nabla \cdot {\overrightarrow {B}}=0,\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;}
     Закон Гаусса для магнетизма

где

  
    
      
        
          
            E
            →
          
        
        =
        [
        V
        
          /
        
        m
        ]
        −
        
        
        
        
      
    
    {\displaystyle {\overrightarrow {E}}=[V/m]-\;\;\;\;}
   Напряженность электрического поля (в системе СИ - [В/м])

  
    
      
        
          
            H
            →
          
        
        =
        [
        A
        
          /
        
        m
        ]
        −
        
        
        
        
      
    
    {\displaystyle {\overrightarrow {H}}=[A/m]-\;\;\;\;}
   Напряженность магнитного поля (в системе СИ - [A/м])

  
    
      
        
          
            B
            →
          
        
        =
        [
        W
        b
        
          /
        
        
          m
          
            2
          
        
        ]
        −
        
        
        
        
      
    
    {\displaystyle {\overrightarrow {B}}=[Wb/m^{2}]-\;\;\;\;}
   Магнитная индукция (в системе СИ - [Вб/м2])

  
    
      
        
          
            D
            →
          
        
        =
        [
        C
        
          /
        
        
          m
          
            2
          
        
        ]
        −
        
        
        
        
      
    
    {\displaystyle {\overrightarrow {D}}=[C/m^{2}]-\;\;\;\;}
   Электрическая индукция (в системе СИ - [Кл/м2])

  
    
      
        
          
            J
            →
          
        
        =
        [
        A
        
          /
        
        
          m
          
            2
          
        
        ]
        −
        
        
        
        
      
    
    {\displaystyle {\overrightarrow {J}}=[A/m^{2}]-\;\;\;\;}
   Плотность электрического тока (в системе СИ - [А/м2])

  
    
      
        ρ
        =
        [
        C
        
          /
        
        
          m
          
            3
          
        
        ]
        −
        
        
        
        
      
    
    {\displaystyle \rho =[C/m^{3}]-\;\;\;\;}
   Плотность стороннего электрического заряда (в системе СИ - [Кл/м3])

В свою очередь, напряженность магнитного поля и магнитная индукция связаны соотношением:

  
    
      
        
          
            H
            →
          
        
        =
        
          
            
              B
              →
            
            
              μ
              
                0
              
            
          
        
        −
        
          
            M
            →
          
        
      
    
    {\displaystyle {\overrightarrow {H}}={\frac {\overrightarrow {B}}{\mu _{0}}}-{\overrightarrow {M}}}
  
где

  
    
      
        
          
            M
            →
          
        
        =
        [
        A
        
          /
        
        m
        ]
        −
        
        
        
        
      
    
    {\displaystyle {\overrightarrow {M}}=[A/m]-\;\;\;\;}
   Намагниченность (в системе СИ - [А/м])

  
    
      
        
          μ
          
            0
          
        
        =
        4
        π
        ×
        
          10
          
            −
            7
          
        
        [
        H
        
          /
        
        m
        ]
        −
        
        
        
        
      
    
    {\displaystyle \mu _{0}=4\pi \times 10^{-7}[H/m]-\;\;\;\;}
   магнитная постоянная (в системе СИ - [Гн/м])

Электрическая индукция и напряженность магнитного поля связаны соотношением:

  
    
      
        
          
            D
            →
          
        
        =
        
          ε
          
            0
          
        
        
          
            E
            →
          
        
        +
        
          
            P
            →
          
        
      
    
    {\displaystyle {\overrightarrow {D}}=\varepsilon _{0}{\overrightarrow {E}}+{\overrightarrow {P}}}
  
где

  
    
      
        
          
            P
            →
          
        
        =
        [
        C
        
          /
        
        
          m
          
            2
          
        
        ]
        −
        
        
        
        
      
    
    {\displaystyle {\overrightarrow {P}}=[C/m^{2}]-\;\;\;\;}
   Вектор поляризации (в системе СИ - [Кл/м2])

  
    
      
        
          ε
          
            0
          
        
        =
        1
        
          /
        
        (
        
          μ
          
            0
          
        
        
          c
          
            2
          
        
        )
        ≈
        8.85
        ×
        
          10
          
            −
            12
          
        
        ×
        
          10
          
            −
            7
          
        
        [
        F
        
          /
        
        m
        ]
        −
        
        
        
        
      
    
    {\displaystyle \varepsilon _{0}=1/(\mu _{0}c^{2})\approx 8.85\times 10^{-12}\times 10^{-7}[F/m]-\;\;\;\;}
   электрическая постоянная (в системе СИ - [Ф/м])

  
    
      
        c
        =
        299792458
        [
        m
        
          /
        
        s
        ]
        −
        
        
        
        
      
    
    {\displaystyle c=299792458[m/s]-\;\;\;\;}
   Постоянная скорости света (в системе СИ - [м/с])

Анализ целостности сигналов
Анализ целостности сигналов можно условно разделить на 3 этапа — анализ кристалла микросхемы, корпуса микросхемы, печатной платы. Проблемы, возникающие на этих этапах, зачастую схожи, но существует ряд принципиальных особенностей, которые не позволяют эффективно анализировать кристалл, корпус и печатную плату в рамках единого САПР (EDA), но ведущие разработчики САПР ведут работы для возможности интеграции этих процессов. На сегодняшний день чаще всего отдельно анализируется кристалл и корпус, а затем данные анализа в виде поведенческих моделей IBIS импортируются в САПР для анализа печатных плат. Стоит отметить, что при таком маршруте проектирования невозможно точно проанализировать все проблемы, которые могут возникнуть в кристалле и в корпусе, особенно, при взаимодействии микросхемы с печатной платой (из-за неидеальности систем заземления и питания, возможных наводок от других микросхем на плате), но получение точных моделей кристалла на транзисторном уровне, таких как SPICE-моделей чаще всего является невозможным, так как это является объектом коммерческой тайны производителя. В том случае, когда производитель микросхем сам пытается тестировать свои кристаллы в готовых изделиях, то он сталкивается с проблемой необходимости использования огромных вычислительных ресурсов.
На каждом из перечисленных этапов анализ целостности сигналов можно разделить на предтопологичесский (pre-layout) и посттопологический (post-layout) анализ.

Предтопологический анализ
Предтопологический анализ включает в себя предварительное исследование системы на наличие в ней проблем с целостностью сигналов, то есть исследование, когда еще не известны точные геометрические размеры системы и точное взаимное расположение компонентов системы. Для проведения такого анализа САПР имеют набор стандартных элементов: линии передач, разъемы, сосредоточенные элементы (конденсаторы, катушки индуктивности, резисторы), переходные отверстия и так далее. Обычно, предтопологический анализ проводят для поиска проблем целостности сигналов в корпусах и печатных платах.

Посттопологический анализ
Посттопологический анализ включает в себя максимально полное исследование системы на наличие проблем целостности сигналов с учетом реальной трассировки, геометрических размеров и положений компонентов, взаимного расположения компонентов. Стоит еще раз отметить, что моделирование всей системы является зачастую нерешаемой задачей из-за отсутствия требуемых данных и невозможности использовать слишком большие вычислительные ресурсы (в том числе и временны́е). Задача инженера по целостности сигналов найти разумное упрощение и моделировать эквивалентную схему с тем, чтобы погрешность не превышала заданную. Для каждого проекта такая погрешность определяется индивидуально. Современные САПР пытаются максимально снять эту проблему с разработчиков и автоматизировать.

Основные проблемы целостности сигналов
Целостность сигналов в линиях передачи данных
Электрический сигнал, вышедший из передатчика, распространившийся в линии передачи, должен быть правильно распознан на входе приемника. Его форма, уровни напряжений, временные параметры - должны точно соответствовать стандарту сигнала. 
Задача сохранения целостности сигнала в линии передачи и предполагает сохранение первоначальной формы напряжения, которую линия передачи или внешние воздействия могут лишь изменить, нарушив первоначальную целостность. 
Линия передачи, в общем случае - это среда распространения. Важно понимать, что в проводную линию передачи входят все элементы между выходом передатчика и входом приемника. А именно, проводники печатных плат, соединительные провода между печатной платой и блочными соединителями, контакты соединителей, как межплатных, так и приборных, электрические кабели. Для получения однородной линии передачи (именно в ней сигнал будет распространяться на максимальные расстояния без отражений) в каждом месте соединения указанных элементов необходимо согласование волнового сопротивления. 
Волновое сопротивление линии передачи для одиночных линий может иметь стандартные значения 50, 75 Ом. Для дифференциальных линий передачи значение дифференциального волнового сопротивления может равняться 90, 100, 120 Ом. Волновое сопротивление может иметь и другие значения. Важно, чтобы на всем протяжении линии передачи данное сопротивление резко не изменялось. При резком изменении волнового сопротивления возникают неоднородности, которые являются причиной отражений. Отраженные от неоднородностей копии сигнала воздействуют на его оригинал и приводят к его искажению. Для оценки степени отражения используют понятие коэффициент отражения. Он показывает, какая часть энергии сигнала отразилась от неоднородности, исходя из различий сопротивлений в месте неоднородности. 
Если линия согласована, коэффициент отражения равен нулю. Такой режим называется режимом бегущей волны и получается при равенстве выходного сопротивления передатчика сопротивлению нагрузки. Если линия не согласована, коэффициент отражения имеет максимальное значение -1. Такой режим называется режим стоячей волны и получается при отсутствии нагрузки (режим холостого хода). В режиме короткого замыкания сопротивление нагрузки можно принять равным нулю и коэффициент отражения будет равен 1. 
Для согласования импедансов применяют различные способы согласования: последовательное, параллельное, комбинированное, схема Тевенина и др.
Если задача однородности линии передачи решена, второе, что требуется для сохранения целостности сигнала, обеспечить такую амплитудно-частотную характеристику линии передачи, которая позволит передать все значимые составляющие спектра сигнала. Это либо первые пять гармоник, либо полоса частот, определяемая скоростью нарастания фронта/спада импульса. Если частотная характеристика линии передачи не имеет провалов, спада в области как нижних, так и верхних частот, резонансных подъемов и локальных всплесков, все составляющие спектра сигнала будут переданы без искажений и форма сигнала не будет нарушена. Фронт и спад останутся монотонными, а площадка импульса - ровной.
Если решена и вторая задача - и частотная характеристика линии передачи равномерна, остается решить третью задачу. Защитить сигнал от влияния внешних сигналов, перекрестных искажений, шумов питания и земли. Если будет решена и третья задача - целостность сигнала на входе приемника будет сохранена. 
Важно понимать, что задача сохранения целостности сигналов актуальна не только для сигналов в диапазоне СВЧ, но и для сигналов низкочастотных, с высокой скоростью нарастания/спада импульса (для более подробной информации см. список литературы: Сохранение целостности электрических сигналов).

Полоса пропускания системы
Раздел радиотехники "Целостность сигналов" появился сравнительно недавно, особенно в российской науке и инженерии. Как следствие, инженеры по целостности сигналов — это чаще всего бывшие инженеры СВЧ. В результате часто возникает непонимание термина "полоса пропускания" для цифрового сигнала. Любой цифровой сигнал характеризуется его скоростью передачи данных (data rate). Рассмотрим для примера произвольный псевдослучайный цифровой сигнал, передаваемый со скоростью 1000Мбит/сек. Означает ли это, что спектр сигнала тоже лежит в области частот до 1ГГц? Ответ на вопрос может дать спектральный анализ, проведенный с использованием инструмента быстрого преобразования Фурье (БПФ/FFT). На рисунке видно, что спектр сигнала гораздо шире его тактовой частоты, и верхней границе соответствует частота «излома», которая определяется крутизной фронта сигнала. Эта частота определяется по формуле:

  
    
      
        
          F
          
            k
            n
            e
            e
          
        
        =
        
          
            1
            
              2
              
                T
                
                  r
                
              
            
          
        
      
    
    {\displaystyle F_{knee}={\frac {1}{2T_{r}}}}
  ,
где 
  
    
      
        
          T
          
            r
          
        
      
    
    {\displaystyle T_{r}}
   — время нарастания (спада) фронта.

Отражения
Отражение — явление возвращения части энергии волны обратно в линию передач при несогласованной нагрузке. Согласованной является нагрузка, комплексное сопротивление которой равно комплексному волновому сопротивлению линии. Чем больше разница между этими двумя импедансами, тем больше будет отражение. Явление отражения становится заметным при увеличении электрической длины (то есть когда длина фронта и длина линии становятся соизмеримыми). Два предельных случая несогласованной линии — это короткозамкнутая 
  
    
      
        (
        
          Z
          
            0
          
        
        =
        0
        )
      
    
    {\displaystyle (Z_{0}=0)}
   и разомкнутая 
  
    
      
        (
        
          Z
          
            0
          
        
        →
        ∞
        )
      
    
    {\displaystyle (Z_{0}\rightarrow \infty )}
   линии.

Волновое сопротивление линии
Волновое сопротивление — сопротивление, которое встречает электромагнитная волна при распространении вдоль однородной линии без отражений. Определяется как отношение напряжения падающей волны к току падающей волны:

  
    
      
        
          Z
          
            0
          
        
        =
        
          
            
              U
              
                Π
              
            
            
              I
              
                Π
              
            
          
        
      
    
    {\displaystyle Z_{0}={\frac {U_{\Pi }}{I_{\Pi }}}}
  .
Для печатных проводников волновое сопротивление линии зависит от её ширины и расстояния до опорного слоя (земли или питания). Волновое сопротивление печатных проводников обычно варьируется в диапазоне от 50 до 75 Ом (могут быть отклонения как в большую, так и в меньшую сторону, но это бывает связано с какой-то узкоспециализированной задачей).

Короткозамкнутая линия
Разомкнутая линия
Согласованная линия
Потери в линиях передач
Омические потери
Омические потери в линиях передач вызваны неидеальностью используемых проводников, которые имеют конечную проводимость (удельная проводимость меди 
  
    
      
        5
        ,
        7
        ⋅
        
          10
          
            7
          
        
      
    
    {\displaystyle 5,7\cdot 10^{7}}
   См/м). Так как проводники имеют вполне определенную толщину при производстве печатных плат (18 мкм для сигнальных проводников и 36 мкм для слоев земли и питания), то омическое сопротивление легко может быть посчитано, если известна величина удельного сопротивления на квадрат. Для проводников из меди толщиной 18 мкм эта величина составляет приблизительно 1 мОм/квадрат. Для примера, проводник шириной 200 мкм и длиной 20 мм будет иметь сопротивление 100 мОм. Такое же сопротивление будет иметь проводник шириной 100 мкм и длиной 10 мм (так как оба проводника имеют «площадь» 100 квадратов).

Поверхностный эффект
Для каждого электрического параметра следует учитывать диапазон частот, в котором он применим. Это относится и к последовательному активному сопротивлению. Постоянный ток и ток низкой частоты распределяется в поперечном сечении равномерно, то есть плотность тока одинакова как в центре проводника, так и у поверхности. На высоких частотах плотность тока возрастает у поверхности проводника и уменьшается почти до нуля в центре. Установлено, что под действием поверхностного эффекта плотность тока экспоненциально снижается по радиусу от поверхности проводника к его центру. Очевидно, что при таком распределении эффективное сопротивление проводника на высоких частотах будет расти. Толщина слоя (скин-слой), в котором будет протекать ток, зависит от частоты:

  
    
      
        s
        =
        
          
            (
            
              
                
                  2
                  ρ
                
                
                  ω
                  μ
                
              
            
            )
          
          
            
              1
              2
            
          
        
      
    
    {\displaystyle s=\left({\frac {2\rho }{\omega \mu }}\right)^{\frac {1}{2}}}
  ,
где 
  
    
      
        ρ
      
    
    {\displaystyle \rho }
   — удельное сопротивление проводника, 
  
    
      
        ω
      
    
    {\displaystyle \omega }
   — частота (в радианах в секунду), 
  
    
      
        μ
      
    
    {\displaystyle \mu }
   — абсолютная магнитная проницаемость проводника.

Диэлектрические потери
Волна без потерь может распространяться только в вакууме. В любом реальном диэлектрике возникают потери. Величина этих потерь зависит от типа диэлектрика и от частоты и определяется коэффициентом диэлектрических потерь. Очевидно, что чем выше диэлектрические потери, тем сильнее ослабление сигнала при распространении. В спецификациях на материал обычно указывается не коэффициент потерь, а тангенс угла потерь. Для удобства рассмотрим идеальный конденсатор. Вектор тока в таком конденсаторе опережает вектор напряжения на 90°. Если в проводнике возникают потери, то происходит сдвиг угла на величину δ, называемую углом потерь. В спецификацию на материал записывают тангенс этого угла. Иногда пользуются величиной обратной тангенсу угла потерь и называемой добротностью:

  
    
      
        Q
        =
        
          
            1
            
              
                t
                g
              
              (
              δ
              )
              
            
          
        
      
    
    {\displaystyle Q={\frac {1}{\mathrm {tg} (\delta )\,}}}
  
Стандартная величина тангенса угла потерь для материала типа FR-4 составляет 0,025.

Перекрестные помехи
Перекрестные помехи — это явление возникновения сигнала в проводнике при воздействии на соседние проводники. В современных цифровых устройствах избежать этого явления невозможно, но его можно минимизировать. Разговаривая о перекрестных помехах вводят два термина — агрессор и жертва. Агрессор — это проводник, на который подается воздействие, а жертва — проводник, с которого снимается отклик этого воздействия. В реальной схеме, когда постоянно происходят переключения различных буферов любой проводник является одновременно и агрессором и жертвой.
Для исследования перекрестных помех на жертву подается напряжение низкого или высокого уровня, а на агрессоры подается меандр, или псевдослучайная последовательность с заданными уровнями логических «0» и «1», скоростью нарастания и скоростью спада фронтов, а также с заданной тактовой частотой.

Шумы питания
Шумы одновременного переключения
Джиттер
См. «Джиттер»

Меры по обеспечению целостности сигналов
Применение
См. также
Радиотехника
Электротехника
Электроника (радиоэлектроника)

Литература
Howard Johnson, High Speed Digital Design: A Handbook of Black Magic ISBN 0133957241
Г. Джонсон, М. Грэхэм, Конструирование высокоскоростных цифровых устройств. Начальный курс черной магии
Howard Johnson, Martin Graham. High-speed signal propagation : advanced black magic. — Upper Saddle River, New Jersey : Prentice Hall PTR, 2002. — ISBN 0-13-084408-X.
Г. Джонсон Высокоскоростная передача цифровых данных: высший курс черной магии
А.В.Трундов Сохранение целостности электрических сигналов. Пособие схемотехникам и конструкторам печатных плат: Издательские решения 2019 ISBN 978-5-4496-7637-5

Ссылки
Basic Principles of Signal Integrity
История развития целостности сигналов глазами Дугласа Брукса