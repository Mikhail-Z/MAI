Преобразование Вигнера — Вилла (англ. Wigner — Ville transform) — один из эффективных методов спектрально-временного анализа нестационарных сигналов. Встречаются другие названия: преобразование Вигнера — Вилля, распределение Вигнера — Вилла (англ. Wigner — Ville distribution), распределение Вигнера — Вилля, функция Вигнера.

Вычисление
P
        
          (
          
            τ
            ,
            f
          
          )
        
        =
        
          ∫
          
            −
            ∞
          
          
            ∞
          
        
        s
        
          (
          
            τ
            +
            
              
                t
                2
              
            
          
          )
        
        ⋅
        
          s
          
            ∗
          
        
        
          (
          
            τ
            −
            
              
                t
                2
              
            
          
          )
        
        ⋅
        
          e
          
            −
            j
            2
            π
            f
            t
          
        
        d
        t
      
    
    {\displaystyle P\left(\tau ,f\right)=\int \limits _{-\infty }^{\infty }s\left(\tau +{\frac {t}{2}}\right)\cdot s^{*}\left(\tau -{\frac {t}{2}}\right)\cdot e^{-j2\pi ft}dt}
  Распределение 
  
    
      
        P
        
          (
          
            τ
            ,
            f
          
          )
        
      
    
    {\displaystyle P\left(\tau ,f\right)}
   может принимать только действительные значения (включая отрицательные).
Несмотря на высокое разрешение, как по частоте, так и по времени, в распределении может порождать побочные частотные компоненты, затрудняющие анализ сигнала. Это связано с нелинейностью преобразования.
Существует несколько методов, позволяющих уменьшить интенсивность побочных компонент, используя определенные процедуры усреднения. Один из них − использование окна h(t) во временной области. В результате
получается так называемое псевдопреобразование Вигнера:

  
    
      
        P
        
          (
          
            τ
            ,
            f
          
          )
        
        =
        
          ∫
          
            −
            ∞
          
          
            ∞
          
        
        h
        (
        t
        )
        ⋅
        s
        
          (
          
            τ
            +
            
              
                t
                2
              
            
          
          )
        
        ⋅
        
          s
          
            ∗
          
        
        
          (
          
            τ
            −
            
              
                t
                2
              
            
          
          )
        
        ⋅
        
          e
          
            −
            j
            2
            π
            f
            t
          
        
        d
        t
      
    
    {\displaystyle P\left(\tau ,f\right)=\int \limits _{-\infty }^{\infty }h(t)\cdot s\left(\tau +{\frac {t}{2}}\right)\cdot s^{*}\left(\tau -{\frac {t}{2}}\right)\cdot e^{-j2\pi ft}dt}
  Если окно прямоугольное:

  
    
      
        h
        (
        t
        )
        =
        
          {
          
            
              
                
                  1
                  ,
                
                
                  −
                  
                    t
                    
                      0
                    
                  
                  ≤
                  t
                  ≤
                  
                    t
                    
                      0
                    
                  
                
              
              
                
                  0
                  ,
                
                
                  
                    |
                  
                  t
                  
                    |
                  
                  >
                  
                    t
                    
                      0
                    
                  
                
              
            
          
          
        
        
          
            ,
          
        
      
    
    {\displaystyle h(t)=\left\{{\begin{array}{ll}1,&-t_{0}\leq t\leq t_{0}\\0,&|t|>t_{0}\end{array}}\right.{\textrm {,}}}
  то при t0→∞ псевдопреобразование Вигнера переходит в обычное преобразование Вигнера — Вилла. При уменьшении t0 интенсивность побочных спектральных компонент снижается, плата за это — ухудшение частотного разрешения.
При анализе оцифрованного сигнала, псевдопреобразование Вигнера удобнее вычислять с помощью быстрого преобразования Фурье (БПФ) в скользящем окне. Для этого,
перед вычислением процедуры БПФ, выборку из сигнала s[n], выделенную скользящим окном размером Nwin отсчетов, преобразуют по следующему алгоритму:
если размер окна нечетный, то

  
    
      
        
          
            
              
                
                  s
                  
                    1
                  
                
                [
                n
                ]
                =
                s
                [
                n
                ]
                ⋅
                
                  s
                  
                    ∗
                  
                
                [
                
                  N
                  
                    w
                    i
                    n
                  
                
                −
                n
                −
                1
                ]
                ,
              
              
                n
                =
                0
                ,
                1
                ,
                …
                ,
                
                  N
                  
                    w
                    i
                    n
                  
                
                −
                1
                ,
              
            
          
        
      
    
    {\displaystyle {\begin{array}{ll}s_{1}[n]=s[n]\cdot s^{*}[N_{win}-n-1],&n=0,1,\ldots ,N_{win}-1,\end{array}}}
  для четного размера окна

  
    
      
        
          
            
              
                
                  s
                  
                    1
                  
                
                [
                n
                ]
                =
                s
                [
                n
                ]
                ⋅
                
                  s
                  
                    ∗
                  
                
                [
                
                  N
                  
                    w
                    i
                    n
                  
                
                −
                n
                −
                2
                ]
                ,
              
              
                n
                =
                0
                ,
                1
                ,
                …
                ,
                
                  N
                  
                    w
                    i
                    n
                  
                
                −
                2
                ,
              
            
            
              
                
                  s
                  
                    1
                  
                
                [
                
                  N
                  
                    w
                    i
                    n
                  
                
                −
                1
                ]
                =
                s
                [
                
                  N
                  
                    w
                    i
                    n
                  
                
                −
                1
                ]
                ⋅
                
                  s
                  
                    ∗
                  
                
                [
                
                  N
                  
                    w
                    i
                    n
                  
                
                −
                1
                ]
                ;
              
              
            
          
        
      
    
    {\displaystyle {\begin{array}{ll}s_{1}[n]=s[n]\cdot s^{*}[N_{win}-n-2],&n=0,1,\ldots ,N_{win}-2,\\s_{1}[N_{win}-1]=s[N_{win}-1]\cdot s^{*}[N_{win}-1];&\end{array}}}
  чтобы результат процедуры БПФ получился действительным, необходимо перед её вычислением выполнить циклическую перестановку полученного сигнала s1[n] влево на (Nwin−1)/2 (если Nwin — нечетное) или на Nwin/2-1 (если Nwin — четное).
При построении вычисленного спектрально-временного распределения все значения на шкале частот следует разделить на 2

Пример использования
Для иллюстрации метода пригодна бесплатная компьютерная программа PSE Lab.
Результат построения спектрально-временного распределения для сигнала, смоделированного на компьютере:

  
    
      
        s
        [
        n
        ]
        =
        exp
        ⁡
        
          (
          
            j
            ⋅
            
              (
              
                2
                π
                ⋅
                0.05
                ⋅
                n
                +
                100
                ⋅
                sin
                ⁡
                
                  (
                  
                    2
                    π
                    ⋅
                    0.0005
                    ⋅
                    n
                  
                  )
                
              
              )
            
          
          )
        
        +
        exp
        ⁡
        
          (
          
            j
            ⋅
            
              (
              
                2
                π
                ⋅
                0.1
                ⋅
                n
                +
                200
                ⋅
                sin
                ⁡
                
                  (
                  
                    2
                    π
                    ⋅
                    0.0005
                    ⋅
                    n
                  
                  )
                
              
              )
            
          
          )
        
        ,
      
    
    {\displaystyle s[n]=\exp \left(j\cdot \left(2\pi \cdot 0.05\cdot n+100\cdot \sin \left(2\pi \cdot 0.0005\cdot n\right)\right)\right)+\exp \left(j\cdot \left(2\pi \cdot 0.1\cdot n+200\cdot \sin \left(2\pi \cdot 0.0005\cdot n\right)\right)\right),}
  состоящего из двух ЧМ компонент, мгновенная цифровая частота одной из них меняется по синусоидальному закону в диапазоне от 0 до 0,1, а другой — от 0 до 0,2, приведены на рисунках.

На рис. 1 представлено спектрально-временное распределение энергии, полученное с помощью псевдопреобразования Вигнера c размером окна Nwin=500 отсчетов. По оси абсцисс отложено время (увеличивается слева-направо), по оси ординат — цифровая частота. Более темные участки распределения соответствуют большей интенсивности.
Для сравнения, на рис. 2 представлена Фурье-спектрограмма, вычисленная с таким же размером окна.
Качественно можно видеть, что спектрально-временное распределение Вигнера — Вилла (рис. 1) имеет более высокое частотно-временное разрешение, по сравнению со спектрограммой (рис. 2).
При увеличении размера окна количество и интенсивность побочных частотных компонент в распределении Вигнера — Вилла увеличиваются, что может осложнить анализ основных частотных компонент (рис. 3).

Примечания
Литература
Коэн Л. Время — частотные распределения: Обзор // ТИИЭР. — 1989. — Т. 77, № 10. — С. 72-120.
Лазоренко О. В. Сверхширокополосные сигналы и физические процессы. 2. Методы анализа и применение // Радиофизика и радиоастрономия. — 2008. — Т. 13, № 4. — С. 270-322.
Лупов С. Ю., Кривошеев В. И. Модификация преобразования Вигнера — Виля для анализа интерферометрических данных газодинамических процессов // Вестник ННГУ. — 2011. — № 5(3). — С. 95-103.
Лупов С. Ю. Частотно — временной анализ интерферометрических данных о газодинамических процессах: Диссертация на соискание учёной степени кандидата физико — математических наук (01.04.03 — Радиофизика). — Н. Новгород, 2012. — 147 с.

Ссылки
PSE Lab (неопр.). — бесплатный программный продукт позволяет вычислить спектрально-временное распределение нестационарных сигналов различными методами (преобразование Вигнера — Вилла и др.). Позволяет оценить спектральную плотность мощности отрезка сигнала различными методами (периодограмма, метод наименьших квадратов Прони, MUSIC и др.). Дата обращения 29 августа 2013. Архивировано 16 сентября 2013 года..
Некоторые оконные функции и их параметры.