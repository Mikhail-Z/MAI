Перевёрнутый маятник представляет собой маятник, который имеет центр масс выше своей точки опоры, закреплённый на конце жёсткого стержня. Часто точка опоры закрепляется на тележке, которая может перемещаться по горизонтали. В то время как нормальный маятник устойчиво висит вниз, обратный маятник по своей природе неустойчивый и должен постоянно балансироваться чтобы оставаться в вертикальном положении, с помощью применения крутящего момента к опорной точке или при перемещении точки опоры по горизонтали, как части обратной связи системы. Простейшим демонстрационным примером может являться балансировка карандаша на конце пальца.

Обзор
Перевёрнутый маятник является классической проблемой динамики и теории управления и широко используется в качестве эталона для тестирования алгоритмов управления (ПИД-регуляторов, нейронных сетей, нечёткого управления и т. д.).
Проблема обратного маятника связана с наведением ракет, так как двигатель ракеты расположен ниже центра тяжести, вызывая нестабильность. Эта же проблема решена, например, в сегвее, самобалансирующемся транспортном устройстве.
Другим способом стабилизации обратного маятника является быстрое колебание основания в вертикальной плоскости. В этом случае можно обойтись без обратной связи. Если колебания достаточно сильные (в смысле величины ускорения и амплитуды), то обратный маятник может стабилизироваться. Если движущаяся точка колеблется в соответствии с простыми гармоническими колебаниями, то движение маятника описывается функцией Матьё.

Уравнения движения
С неподвижной точкой опоры
Уравнение движения аналогично прямому маятнику за исключением того, что знак углового положения, измеряется от вертикальной позиции неустойчивого равновесия:

  
    
      
        
          
            
              θ
              ¨
            
          
        
        −
        
          
            g
            ℓ
          
        
        sin
        ⁡
        θ
        =
        0
      
    
    {\displaystyle {\ddot {\theta }}-{g \over \ell }\sin \theta =0}
  При переносе, он будет иметь тот же знак углового ускорения:

  
    
      
        
          
            
              θ
              ¨
            
          
        
        =
        
          
            g
            ℓ
          
        
        sin
        ⁡
        θ
      
    
    {\displaystyle {\ddot {\theta }}={g \over \ell }\sin \theta }
  Таким образом, обратный маятник будет ускоряться от вертикального неустойчивого равновесия в противоположную сторону, а ускорение будет обратно пропорционально длине. Высокий маятник падает медленнее, чем короткий.

Маятник на тележке
Уравнения движения могут быть получены с использованием уравнений Лагранжа. Речь идёт об приведённом выше рисунке, где 
  
    
      
        θ
        (
        t
        )
      
    
    {\displaystyle \theta (t)}
   угол маятника длиной 
  
    
      
        l
      
    
    {\displaystyle l}
   по отношению к вертикали и действующей силе гравитации и внешних сил 
  
    
      
        F
      
    
    {\displaystyle F}
   в направлении 
  
    
      
        x
      
    
    {\displaystyle x}
  . Определим 
  
    
      
        x
        (
        t
        )
      
    
    {\displaystyle x(t)}
   положение тележки. Лагранжиан 
  
    
      
        L
        =
        T
        −
        V
      
    
    {\displaystyle L=T-V}
   системы:

  
    
      
        L
        =
        
          
            1
            2
          
        
        M
        
          v
          
            1
          
          
            2
          
        
        +
        
          
            1
            2
          
        
        m
        
          v
          
            2
          
          
            2
          
        
        −
        m
        g
        ℓ
        cos
        ⁡
        θ
      
    
    {\displaystyle L={\frac {1}{2}}Mv_{1}^{2}+{\frac {1}{2}}mv_{2}^{2}-mg\ell \cos \theta }
  где 
  
    
      
        
          v
          
            1
          
        
      
    
    {\displaystyle v_{1}}
   является скоростью тележки, а 
  
    
      
        
          v
          
            2
          
        
      
    
    {\displaystyle v_{2}}
   - скорость материальной точки 
  
    
      
        m
      
    
    {\displaystyle m}
  .

  
    
      
        
          v
          
            1
          
        
      
    
    {\displaystyle v_{1}}
   и 
  
    
      
        
          v
          
            2
          
        
      
    
    {\displaystyle v_{2}}
   может быть выражена через 
  
    
      
        x
      
    
    {\displaystyle x}
   и 
  
    
      
        θ
      
    
    {\displaystyle \theta }
   путём записи скорости как первой производной положения.

  
    
      
        
          v
          
            1
          
          
            2
          
        
        =
        
          
            
              
                x
                ˙
              
            
          
          
            2
          
        
      
    
    {\displaystyle v_{1}^{2}={\dot {x}}^{2}}
  

  
    
      
        
          v
          
            2
          
          
            2
          
        
        =
        
          
            (
            
              
                
                  d
                  
                    d
                    t
                  
                
              
              
                
                  (
                  
                    x
                    −
                    ℓ
                    sin
                    ⁡
                    θ
                  
                  )
                
              
            
            )
          
          
            2
          
        
        +
        
          
            (
            
              
                
                  d
                  
                    d
                    t
                  
                
              
              
                
                  (
                  
                    ℓ
                    cos
                    ⁡
                    θ
                  
                  )
                
              
            
            )
          
          
            2
          
        
      
    
    {\displaystyle v_{2}^{2}=\left({\frac {d}{dt}}{\left(x-\ell \sin \theta \right)}\right)^{2}+\left({\frac {d}{dt}}{\left(\ell \cos \theta \right)}\right)^{2}}
  Упрощение выражения 
  
    
      
        
          v
          
            2
          
        
      
    
    {\displaystyle v_{2}}
   приводит к:

  
    
      
        
          v
          
            2
          
          
            2
          
        
        =
        
          
            
              
                x
                ˙
              
            
          
          
            2
          
        
        −
        2
        ℓ
        
          
            
              x
              ˙
            
          
        
        
          
            
              θ
              ˙
            
          
        
        cos
        ⁡
        θ
        +
        
          ℓ
          
            2
          
        
        
          
            
              
                θ
                ˙
              
            
          
          
            2
          
        
      
    
    {\displaystyle v_{2}^{2}={\dot {x}}^{2}-2\ell {\dot {x}}{\dot {\theta }}\cos \theta +\ell ^{2}{\dot {\theta }}^{2}}
  Лагранжиан теперь определяется по формуле:

  
    
      
        L
        =
        
          
            1
            2
          
        
        
          (
          
            M
            +
            m
          
          )
        
        
          
            
              
                x
                ˙
              
            
          
          
            2
          
        
        −
        m
        ℓ
        
          
            
              x
              ˙
            
          
        
        
          
            
              θ
              ˙
            
          
        
        cos
        ⁡
        θ
        +
        
          
            1
            2
          
        
        m
        
          ℓ
          
            2
          
        
        
          
            
              
                θ
                ˙
              
            
          
          
            2
          
        
        −
        m
        g
        ℓ
        cos
        ⁡
        θ
      
    
    {\displaystyle L={\frac {1}{2}}\left(M+m\right){\dot {x}}^{2}-m\ell {\dot {x}}{\dot {\theta }}\cos \theta +{\frac {1}{2}}m\ell ^{2}{\dot {\theta }}^{2}-mg\ell \cos \theta }
  и уравнения движения:

  
    
      
        
          
            
              d
            
            
              
                d
              
              t
            
          
        
        
          
            
              ∂
              
                L
              
            
            
              ∂
              
                
                  
                    x
                    ˙
                  
                
              
            
          
        
        −
        
          
            
              ∂
              
                L
              
            
            
              ∂
              x
            
          
        
        =
        F
      
    
    {\displaystyle {\frac {\mathrm {d} }{\mathrm {d} t}}{\partial {L} \over \partial {\dot {x}}}-{\partial {L} \over \partial x}=F}
  
  
    
      
        
          
            
              d
            
            
              
                d
              
              t
            
          
        
        
          
            
              ∂
              
                L
              
            
            
              ∂
              
                
                  
                    θ
                    ˙
                  
                
              
            
          
        
        −
        
          
            
              ∂
              
                L
              
            
            
              ∂
              θ
            
          
        
        =
        0
      
    
    {\displaystyle {\frac {\mathrm {d} }{\mathrm {d} t}}{\partial {L} \over \partial {\dot {\theta }}}-{\partial {L} \over \partial \theta }=0}
  Подстановка 
  
    
      
        L
      
    
    {\displaystyle L}
   в эти выражения с последующим упрощением приводит к уравнениям, описывающим движение обратного маятника:

  
    
      
        
          (
          
            M
            +
            m
          
          )
        
        
          
            
              x
              ¨
            
          
        
        −
        m
        ℓ
        
          
            
              θ
              ¨
            
          
        
        cos
        ⁡
        θ
        +
        m
        ℓ
        
          
            
              
                θ
                ˙
              
            
          
          
            2
          
        
        sin
        ⁡
        θ
        =
        F
      
    
    {\displaystyle \left(M+m\right){\ddot {x}}-m\ell {\ddot {\theta }}\cos \theta +m\ell {\dot {\theta }}^{2}\sin \theta =F}
  

  
    
      
        ℓ
        
          
            
              θ
              ¨
            
          
        
        −
        g
        sin
        ⁡
        θ
        =
        
          
            
              x
              ¨
            
          
        
        cos
        ⁡
        θ
      
    
    {\displaystyle \ell {\ddot {\theta }}-g\sin \theta ={\ddot {x}}\cos \theta }
  Эти уравнения являются нелинейными, но, поскольку цель системы управления - удерживать маятник вертикально, то уравнения можно линеаризовать, приняв 
  
    
      
        θ
        ≈
        0
      
    
    {\displaystyle \theta \approx 0}
  .

Маятник с колеблющимся основанием
Уравнение движения для такого маятника связано с безмассовой осциллирующей базой и получено так же, как для маятника на тележке. Положение материальной точки определяется по формуле:

  
    
      
        
          (
          
            −
            ℓ
            sin
            ⁡
            θ
            ,
            y
            +
            ℓ
            cos
            ⁡
            θ
          
          )
        
      
    
    {\displaystyle \left(-\ell \sin \theta ,y+\ell \cos \theta \right)}
  и скорость найдена через первую производную позиции:

  
    
      
        
          v
          
            2
          
        
        =
        
          
            
              
                y
                ˙
              
            
          
          
            2
          
        
        −
        2
        ℓ
        
          
            
              y
              ˙
            
          
        
        
          
            
              θ
              ˙
            
          
        
        sin
        ⁡
        θ
        +
        
          ℓ
          
            2
          
        
        
          
            
              
                θ
                ˙
              
            
          
          
            2
          
        
        .
      
    
    {\displaystyle v^{2}={\dot {y}}^{2}-2\ell {\dot {y}}{\dot {\theta }}\sin \theta +\ell ^{2}{\dot {\theta }}^{2}.}
  Лагранжиан для этой системы можно записать в виде:

  
    
      
        L
        =
        
          
            1
            2
          
        
        m
        
          (
          
            
              
                
                  
                    y
                    ˙
                  
                
              
              
                2
              
            
            −
            2
            ℓ
            
              
                
                  y
                  ˙
                
              
            
            
              
                
                  θ
                  ˙
                
              
            
            sin
            ⁡
            θ
            +
            
              ℓ
              
                2
              
            
            
              
                
                  
                    θ
                    ˙
                  
                
              
              
                2
              
            
          
          )
        
        −
        m
        g
        
          (
          
            y
            +
            ℓ
            cos
            ⁡
            θ
          
          )
        
      
    
    {\displaystyle L={\frac {1}{2}}m\left({\dot {y}}^{2}-2\ell {\dot {y}}{\dot {\theta }}\sin \theta +\ell ^{2}{\dot {\theta }}^{2}\right)-mg\left(y+\ell \cos \theta \right)}
  уравнения движения следуют из:

  
    
      
        
          
            
              d
            
            
              
                d
              
              t
            
          
        
        
          
            
              ∂
              
                L
              
            
            
              ∂
              
                
                  
                    θ
                    ˙
                  
                
              
            
          
        
        −
        
          
            
              ∂
              
                L
              
            
            
              ∂
              θ
            
          
        
        =
        0
      
    
    {\displaystyle {\mathrm {d}  \over \mathrm {d} t}{\partial {L} \over \partial {\dot {\theta }}}-{\partial {L} \over \partial \theta }=0}
  в результате:

  
    
      
        ℓ
        
          
            
              θ
              ¨
            
          
        
        −
        
          
            
              y
              ¨
            
          
        
        sin
        ⁡
        θ
        =
        g
        sin
        ⁡
        θ
        .
      
    
    {\displaystyle \ell {\ddot {\theta }}-{\ddot {y}}\sin \theta =g\sin \theta .}
  Если y колеблется в соответствии с простыми гармоническими колебаниями, 
  
    
      
        y
        =
        A
        sin
        ⁡
        ω
        t
      
    
    {\displaystyle y=A\sin \omega t}
  , то получаем дифференциальное уравнение:

  
    
      
        
          
            
              θ
              ¨
            
          
        
        −
        
          
            g
            ℓ
          
        
        sin
        ⁡
        θ
        =
        −
        
          
            A
            ℓ
          
        
        
          ω
          
            2
          
        
        sin
        ⁡
        ω
        t
        sin
        ⁡
        θ
        .
      
    
    {\displaystyle {\ddot {\theta }}-{g \over \ell }\sin \theta =-{A \over \ell }\omega ^{2}\sin \omega t\sin \theta .}
  Это уравнение не имеет элементарного решения в замкнутом виде, но может быть изучено во множестве направлений. Оно близкого к уравнению Матье, например, когда амплитуда колебаний мала. Анализ показывает, что маятник остается в вертикальном положении при быстрых колебаниях. Первый график показывает, что при медленно колеблющимся 
  
    
      
        y
      
    
    {\displaystyle y}
  , маятник быстро падает, после выхода из устойчивого вертикального положения. Если 
  
    
      
        y
      
    
    {\displaystyle y}
   быстро колеблется, то маятник может быть стабилен около вертикальной позиции. Второй график показывает, что, после выхода из устойчивого вертикального положения, маятник теперь начинается колебаться вокруг вертикальной позиции (
  
    
      
        θ
        =
        0
      
    
    {\displaystyle \theta =0}
  ).Отклонение от вертикального положения остается мало, и маятник не падает.

Применение
Примером является балансировка людей и предметов, например в акробатике или катание на одноколесном велосипеде. А также сегве́й — электрический самобалансирующийся самокат с двумя колёсами.

Перевернутый маятник был центральным компонентом в разработке нескольких ранних сейсмографов.

См. также
Self-balancing unicycle
Сегвей
Двойной обратный маятник
Гироскопический маятник
Furuta pendulum

Ссылки
D. Liberzon Switching in Systems and Control (2003 Springer) pp. 89ff

Дальнейшее чтение
Franklin; et al. (2005). Feedback control of dynamic systems, 5, Prentice Hall. ISBN 0-13-149930-0

Ссылки
YouTube — Обратный маятник
Моделирование динамики обратного маятника на колебательной базе
Моделирование обратного маятника в Matlab