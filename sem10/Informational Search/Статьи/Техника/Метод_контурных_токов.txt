Ме́тод ко́нтурных то́ков — метод сокращения размерности системы уравнений, описывающей электрическую цепь.
Метод контурных токов — метод расчёта электрических цепей, при котором за неизвестные принимаются токи в контурах, образованных некоторым условным делением электрической цепи.

Основные принципы
Любая электрическая цепь, состоящая из Р рёбер (ветвей, участков, звеньев) и У узлов, может быть описана системой уравнений в соответствии с 1-м и 2-м правилами Кирхгофа. Число уравнений в такой системе равно Р, из них У–1 уравнений составляется по 1-му правилу Кирхгофа для всех узлов, кроме одного; а остальные Р–У+1 уравнений – по 2-му правилу Кирхгофа для всех независимых контуров. Поскольку независимыми переменными в цепи считаются токи рёбер, число независимых переменных равно числу уравнений, и система разрешима.
Существует несколько методов сократить число уравнений в системе. Одним из таких методов является метод контурных токов.
Метод использует тот факт, что не все токи в рёбрах цепи являются независимыми. Наличие в системе У–1 уравнений для узлов означает, что зависимы У–1 токов. Если выделить в цепи Р–У+1 независимых токов, то систему можно сократить до Р–У+1 уравнений. Метод контурных токов основан на очень простом и удобном способе выделения в цепи Р–У+1 независимых токов.
Метод контурных токов основан на допущении, что в каждом из Р–У+1 независимых контуров схемы циркулирует некоторый виртуальный контурный ток. Если некоторое ребро принадлежит только одному контуру, реальный ток в нём равен контурному. Если же ребро принадлежит нескольким контурам, ток в нём равен сумме соответствующих контурных токов (с учётом направления обхода контуров). Поскольку независимые контура покрывают собой всю схему (т.е. любое ребро принадлежит хотя бы одному контуру), то ток в любом ребре можно выразить через контурные токи, и контурные токи составляют полную систему токов.

Построение системы контуров
Использование планарных графов
Наиболее простым и наглядным методом построения системы независимых контуров является построение планарного графа схемы, то есть размещение ветвей и узлов цепи на плоскости без взаимных пересечений рёбер. Планарный граф разбивает плоскость на К ограниченных областей. Можно показать, что замкнутые цепочки рёбер, ограничивающие эти области, являются системой независимых контуров для рассматриваемой схемы.
Метод планарного графа предпочтителен при ручном расчёте схем. В случае, если схему невозможно изобразить в виде планарного графа, а также в случае компьютерного построения системы контуров применение этого метода может оказаться невозможным.

Метод выделения максимального дерева
Дерево представляет собой подмножество звеньев цепи, представляющее собой односвязный (то есть состоящий из одной части) граф, в котором нет замкнутых контуров. Дерево получается из цепи путём исключения из него некоторых звеньев. Максимальное дерево - это дерево, для которого добавление к нему любого исключённого звена приводит к образованию контура.
Метод выделения максимального дерева основан на последовательном исключении из цепи определённых звеньев согласно следующим правилам:

На каждом шагу из цепи в произвольном порядке исключается одно звено;
Если исключение звена приводит к нарушению односвязности графа (то есть граф разбивается на две изолированных части, либо появляются «висящие» узлы), то звено возвращается в цепь;
Если при исключении звена граф не теряет односвязности, звено остаётся исключённым;
Переходим к следующему шагу.В конце работы алгоритма число исключённых из цепи звеньев оказывается точно равно числу независимых контуров схемы. Каждый независимый контур получается присоединением к цепи соответствующего исключённого звена.
Пример выделения максимального дерева

Построение системы уравнений
Для построения системы уравнений необходимо выделить в цепи P – У + 1 независимых контуров. По каждому из этих контуров будет составлено одно уравнение по 2-му закону Кирхгофа. В каждом контуре необходимо выбрать направление обхода (например, по часовой стрелке).
Выделение независимых контуров можно осуществить одним из перечисленных выше методов. Следует отметить, что система независимых контуров, как правило, не единственна, как не единственно и максимальное дерево цепи. Однако системы уравнений, составленные по различным системам контуров, математически эквивалентны, поэтому возможен специальный подбор системы контуров, дающей наиболее простую систему уравнений.
Отметим также, что при любом выборе системы контуров в любом контуре обязательно найдётся ребро, которое входит только в этот контур и ни в какой другой. Таким образом, контурный ток всегда совпадает с током в одном из рёбер этого контура. Например, для схемы, изображённой на рисунке, звено 4 входит только в левый контур, поэтому контурный ток обозначен как I4. То же самое относится к двум другим контурам, токи в которых обозначены как I5 и I6. В литературе встречаются и другие обозначения для контурных токов, например, римскими цифрами (II, III, IIII ...), латинскими буквами (IA, IB, IC ...) и т.д.
Принцип построения системы уравнений следующий.

Все токи в звеньях выражаем через контурные токи. В данном случае необходимо выразить только те токи, которые не совпадают с одним из контурных токов:
  
    
      
        
          I
          
            1
          
        
        =
        
          I
          
            6
          
        
        −
        
          I
          
            4
          
        
        ;
        
        
          I
          
            2
          
        
        =
        
          I
          
            5
          
        
        −
        
          I
          
            4
          
        
        ;
        
        
          I
          
            3
          
        
        =
        
          I
          
            6
          
        
        −
        
          I
          
            5
          
        
        ;
      
    
    {\displaystyle I_{1}=I_{6}-I_{4};\quad I_{2}=I_{5}-I_{4};\quad I_{3}=I_{6}-I_{5};}
  Для каждого контура записываем уравнение по второму закону Кирхгофа:
В левой части каждого уравнения записываем сумму токов в звеньях, входящих в контур, умноженных на сопротивление соответствующего звена. Суммирование происходит с учётом знака: если ток в звене совпадает с направлением обхода контура, слагаемое записывается со знаком «плюс», в противном случае — со знаком «минус».
В правой части каждого уравнения записываем сумму ЭДС источников, а также сумму произведений токов источников на сопротивление соответствующего звена. Суммирование также происходит с учётом знака, в зависимости от совпадения или несовпадения направления источника с направлением контурного тока:
Для первого контура (I4):

  
    
      
        −
        
          I
          
            1
          
        
        
          Z
          
            1
          
        
        −
        
          I
          
            2
          
        
        
          Z
          
            2
          
        
        +
        
          I
          
            4
          
        
        
          Z
          
            4
          
        
        =
        
          E
          
            4
          
        
        ;
      
    
    {\displaystyle -I_{1}Z_{1}-I_{2}Z_{2}+I_{4}Z_{4}=E_{4};}
  

  
    
      
        −
        (
        
          I
          
            6
          
        
        −
        
          I
          
            4
          
        
        )
        
          Z
          
            1
          
        
        −
        (
        
          I
          
            5
          
        
        −
        
          I
          
            4
          
        
        )
        
          Z
          
            2
          
        
        +
        
          I
          
            4
          
        
        
          Z
          
            4
          
        
        =
        
          E
          
            4
          
        
        ;
      
    
    {\displaystyle -(I_{6}-I_{4})Z_{1}-(I_{5}-I_{4})Z_{2}+I_{4}Z_{4}=E_{4};}
  

  
    
      
        (
        
          Z
          
            1
          
        
        +
        
          Z
          
            2
          
        
        +
        
          Z
          
            4
          
        
        )
        
          I
          
            4
          
        
        −
        
          Z
          
            2
          
        
        
          I
          
            5
          
        
        −
        
          Z
          
            1
          
        
        
          I
          
            6
          
        
        =
        
          E
          
            4
          
        
        ;
      
    
    {\displaystyle (Z_{1}+Z_{2}+Z_{4})I_{4}-Z_{2}I_{5}-Z_{1}I_{6}=E_{4};}
  Для второго контура (I5):

  
    
      
        
          I
          
            2
          
        
        
          Z
          
            2
          
        
        −
        
          I
          
            3
          
        
        
          Z
          
            3
          
        
        +
        
          I
          
            5
          
        
        
          Z
          
            5
          
        
        =
        
          J
          
            5
          
        
        
          Z
          
            5
          
        
        ;
      
    
    {\displaystyle I_{2}Z_{2}-I_{3}Z_{3}+I_{5}Z_{5}=J_{5}Z_{5};}
  

  
    
      
        (
        
          I
          
            5
          
        
        −
        
          I
          
            4
          
        
        )
        
          Z
          
            2
          
        
        −
        (
        
          I
          
            6
          
        
        −
        
          I
          
            5
          
        
        )
        
          Z
          
            3
          
        
        +
        
          I
          
            5
          
        
        
          Z
          
            5
          
        
        =
        
          J
          
            5
          
        
        
          Z
          
            5
          
        
        ;
      
    
    {\displaystyle (I_{5}-I_{4})Z_{2}-(I_{6}-I_{5})Z_{3}+I_{5}Z_{5}=J_{5}Z_{5};}
  

  
    
      
        −
        
          Z
          
            2
          
        
        
          I
          
            4
          
        
        +
        (
        
          Z
          
            2
          
        
        +
        
          Z
          
            3
          
        
        +
        
          Z
          
            5
          
        
        )
        
          I
          
            5
          
        
        −
        
          Z
          
            3
          
        
        
          I
          
            6
          
        
        =
        
          J
          
            5
          
        
        
          Z
          
            5
          
        
        ;
      
    
    {\displaystyle -Z_{2}I_{4}+(Z_{2}+Z_{3}+Z_{5})I_{5}-Z_{3}I_{6}=J_{5}Z_{5};}
  Для третьего контура (I6):

  
    
      
        
          I
          
            1
          
        
        
          Z
          
            1
          
        
        +
        
          I
          
            3
          
        
        
          Z
          
            3
          
        
        +
        
          I
          
            6
          
        
        
          Z
          
            6
          
        
        =
        
          E
          
            6
          
        
        ;
      
    
    {\displaystyle I_{1}Z_{1}+I_{3}Z_{3}+I_{6}Z_{6}=E_{6};}
  

  
    
      
        (
        
          I
          
            6
          
        
        −
        
          I
          
            4
          
        
        )
        
          Z
          
            1
          
        
        +
        (
        
          I
          
            6
          
        
        −
        
          I
          
            5
          
        
        )
        
          Z
          
            3
          
        
        +
        
          I
          
            6
          
        
        
          Z
          
            6
          
        
        =
        
          E
          
            6
          
        
        ;
      
    
    {\displaystyle (I_{6}-I_{4})Z_{1}+(I_{6}-I_{5})Z_{3}+I_{6}Z_{6}=E_{6};}
  

  
    
      
        −
        
          Z
          
            1
          
        
        
          I
          
            4
          
        
        +
        −
        
          Z
          
            3
          
        
        
          I
          
            5
          
        
        +
        (
        
          Z
          
            1
          
        
        +
        
          Z
          
            3
          
        
        +
        
          Z
          
            6
          
        
        )
        
          I
          
            6
          
        
        =
        
          E
          
            6
          
        
        ;
      
    
    {\displaystyle -Z_{1}I_{4}+-Z_{3}I_{5}+(Z_{1}+Z_{3}+Z_{6})I_{6}=E_{6};}
  Окончательно получаем систему уравнений

  
    
      
        
          
            {
            
              
                
                  (
                  
                    Z
                    
                      1
                    
                  
                  +
                  
                    Z
                    
                      2
                    
                  
                  +
                  
                    Z
                    
                      4
                    
                  
                  )
                  ⋅
                  
                    I
                    
                      4
                    
                  
                  −
                  
                    Z
                    
                      2
                    
                  
                  ⋅
                  
                    I
                    
                      5
                    
                  
                  −
                  
                    Z
                    
                      1
                    
                  
                  ⋅
                  
                    I
                    
                      6
                    
                  
                  =
                  
                    E
                    
                      4
                    
                  
                
              
              
                
                  −
                  
                    Z
                    
                      2
                    
                  
                  ⋅
                  
                    I
                    
                      4
                    
                  
                  +
                  (
                  
                    Z
                    
                      2
                    
                  
                  +
                  
                    Z
                    
                      3
                    
                  
                  +
                  
                    Z
                    
                      5
                    
                  
                  )
                  ⋅
                  
                    I
                    
                      5
                    
                  
                  −
                  
                    Z
                    
                      3
                    
                  
                  ⋅
                  
                    I
                    
                      6
                    
                  
                  =
                  
                    Z
                    
                      5
                    
                  
                  
                    J
                    
                      5
                    
                  
                
              
              
                
                  −
                  
                    Z
                    
                      1
                    
                  
                  ⋅
                  
                    I
                    
                      4
                    
                  
                  −
                  
                    Z
                    
                      3
                    
                  
                  ⋅
                  
                    I
                    
                      5
                    
                  
                  +
                  (
                  
                    Z
                    
                      1
                    
                  
                  +
                  
                    Z
                    
                      3
                    
                  
                  +
                  
                    Z
                    
                      6
                    
                  
                  )
                  ⋅
                  
                    I
                    
                      6
                    
                  
                  =
                  
                    E
                    
                      6
                    
                  
                
              
            
            
          
        
        .
      
    
    {\displaystyle {\begin{cases}(Z_{1}+Z_{2}+Z_{4})\cdot I_{4}-Z_{2}\cdot I_{5}-Z_{1}\cdot I_{6}=E_{4}\\-Z_{2}\cdot I_{4}+(Z_{2}+Z_{3}+Z_{5})\cdot I_{5}-Z_{3}\cdot I_{6}=Z_{5}J_{5}\\-Z_{1}\cdot I_{4}-Z_{3}\cdot I_{5}+(Z_{1}+Z_{3}+Z_{6})\cdot I_{6}=E_{6}\end{cases}}.}

Оптимизированная процедура составления системы
Как видно из вышесказанного, процедуру составления системы можно упростить следующим образом:

В левой части К-го уравнения записываем произведение контурного тока на сумму сопротивлений всех звеньев, входящих в контур:
  
    
      
        
          I
          
            K
          
        
        (
        
          Z
          
            K
            1
          
        
        +
        
          Z
          
            K
            2
          
        
        +
        .
        .
        .
        )
        +
        .
        .
        .
        ,
      
    
    {\displaystyle I_{K}(Z_{K1}+Z_{K2}+...)+...,}
  где 
  
    
      
         
        
          I
          
            K
          
        
      
    
    {\displaystyle \ I_{K}}
   — ток контура, для которого записывается уравнение;

  
    
      
         
        
          Z
          
            K
            1
          
        
        .
        .
        .
        
          Z
          
            K
            n
          
        
      
    
    {\displaystyle \ Z_{K1}...Z_{Kn}}
   — сопротивления звеньев, входящих в этот контур.

От левой части уравнения отнимаем остальные контурные токи, умноженные на суммы сопротивлений звеньев, по которым контур К пересекается с этими контурами:
  
    
      
        .
        .
        .
        −
        
          I
          
            A
          
        
        (
        
          Z
          
            K
            A
            1
          
        
        +
        
          Z
          
            K
            A
            2
          
        
        +
        .
        .
        .
        )
        −
        
          I
          
            B
          
        
        (
        
          Z
          
            K
            B
            1
          
        
        +
        
          Z
          
            K
            B
            2
          
        
        +
        .
        .
        .
        )
        −
        .
        .
        .
      
    
    {\displaystyle ...-I_{A}(Z_{KA1}+Z_{KA2}+...)-I_{B}(Z_{KB1}+Z_{KB2}+...)-...}
  где 
  
    
      
         
        
          I
          
            A
          
        
        ,
        
          I
          
            B
          
        
        ,
        .
        .
        .
      
    
    {\displaystyle \ I_{A},I_{B},...}
   — токи контуров, пересекающихся с контуром К;

  
    
      
         
        
          Z
          
            K
            A
            1
          
        
        ,
        
          Z
          
            K
            A
            2
          
        
        ,
        .
        .
        .
      
    
    {\displaystyle \ Z_{KA1},Z_{KA2},...}
   — сопротивления звеньев, входящих одновременно в контура К и A.

В правой части уравнения записываем сумму источников ЭДС с учётом знаков («плюс» — если направления ЭДС и обхода контура совпадают, «минус» — в противном случае):
  
    
      
        .
        .
        .
        =
        ±
        
          E
          
            K
            1
          
        
        ±
        
          E
          
            K
            2
          
        
        .
        .
        .
      
    
    {\displaystyle ...=\pm E_{K1}\pm E_{K2}...}
  К правой части уравнения прибавляем величины источников тока, умноженные на сопротивление соответствующего звена с учётом знаков («плюс» — если направления источника тока и обхода контура совпадают, «минус» — в противном случае):
  
    
      
        .
        .
        .
        ±
        
          J
          
            K
            1
          
        
        
          Z
          
            K
            1
          
        
        ±
        
          J
          
            K
            2
          
        
        
          Z
          
            K
            2
          
        
        .
        .
        .
      
    
    {\displaystyle ...\pm J_{K1}Z_{K1}\pm J_{K2}Z_{K2}...}
  Составив уравнения для всех независимых контуров, получаем совместную систему P–У+1 уравнений относительно P–У+1 неизвестных контурных токов.

Пример
Положим, что в левом контуре по часовой стрелке течет контурный ток I11, а в правом (также по часовой стрелке) — контурный ток I22. Для каждого из контуров составим уравнения по второму закону Кирхгофа. При этом учтем, что по смежной ветви (с сопротивлением R5) течет сверху вниз ток I11–I22. Направления обхода контуров примем также по часовой стрелке.

  
    
      
        
          
            {
            
              
                
                  (
                  
                    R
                    
                      1
                    
                  
                  +
                  
                    R
                    
                      2
                    
                  
                  +
                  
                    R
                    
                      5
                    
                  
                  )
                  
                    I
                    
                      11
                    
                  
                  +
                  (
                  −
                  
                    R
                    
                      5
                    
                  
                  )
                  
                    I
                    
                      22
                    
                  
                  =
                  
                    E
                    
                      1
                    
                  
                  +
                  
                    E
                    
                      5
                    
                  
                
              
              
                
                  (
                  −
                  
                    R
                    
                      5
                    
                  
                  )
                  
                    I
                    
                      11
                    
                  
                  +
                  (
                  
                    R
                    
                      3
                    
                  
                  +
                  
                    R
                    
                      4
                    
                  
                  +
                  
                    R
                    
                      5
                    
                  
                  )
                  
                    I
                    
                      22
                    
                  
                  =
                  −
                  
                    E
                    
                      5
                    
                  
                  −
                  
                    E
                    
                      4
                    
                  
                
              
            
            
          
        
      
    
    {\displaystyle {\begin{cases}(R_{1}+R_{2}+R_{5})I_{11}+(-R_{5})I_{22}=E_{1}+E_{5}\\(-R_{5})I_{11}+(R_{3}+R_{4}+R_{5})I_{22}=-E_{5}-E_{4}\\\end{cases}}}
  Перепишем эти уравнения следующим образом:

  
    
      
        
          
            {
            
              
                
                  
                    R
                    
                      11
                    
                  
                  
                    I
                    
                      11
                    
                  
                  +
                  
                    R
                    
                      12
                    
                  
                  
                    I
                    
                      22
                    
                  
                  =
                  
                    E
                    
                      11
                    
                  
                
              
              
                
                  
                    R
                    
                      21
                    
                  
                  
                    I
                    
                      11
                    
                  
                  +
                  
                    R
                    
                      22
                    
                  
                  
                    I
                    
                      22
                    
                  
                  =
                  
                    E
                    
                      22
                    
                  
                
              
            
            
          
        
        ,
      
    
    {\displaystyle {\begin{cases}R_{11}I_{11}+R_{12}I_{22}=E_{11}\\R_{21}I_{11}+R_{22}I_{22}=E_{22}\\\end{cases}},}
  где

  
    
      
        
          R
          
            11
          
        
        =
        
          R
          
            1
          
        
        +
        
          R
          
            2
          
        
        +
        
          R
          
            5
          
        
      
    
    {\displaystyle R_{11}=R_{1}+R_{2}+R_{5}}
   — полное сопротивление первого контура;

  
    
      
        
          R
          
            22
          
        
        =
        
          R
          
            3
          
        
        +
        
          R
          
            4
          
        
        +
        
          R
          
            5
          
        
      
    
    {\displaystyle R_{22}=R_{3}+R_{4}+R_{5}}
   — полное сопротивление второго контура;

  
    
      
        
          R
          
            12
          
        
        =
        
          R
          
            21
          
        
        =
        −
        
          R
          
            5
          
        
      
    
    {\displaystyle R_{12}=R_{21}=-R_{5}}
   — сопротивления смежной ветви между первым и вторым контурами, взятые со знаком минус;

  
    
      
        
          E
          
            11
          
        
        =
        
          E
          
            1
          
        
        +
        
          E
          
            5
          
        
      
    
    {\displaystyle E_{11}=E_{1}+E_{5}}
   — контурная ЭДС первого контура;

  
    
      
        
          E
          
            22
          
        
        =
        −
        
          E
          
            4
          
        
        −
        
          E
          
            5
          
        
      
    
    {\displaystyle E_{22}=-E_{4}-E_{5}}
   — контурная ЭДС второго контура.

Формальный подход
В матричном виде система уравнений для метода контурных токов выглядит следующим образом:

  
    
      
        
          C
          Z
          
            C
            
              t
            
          
          
            I
            
              2
            
          
          =
          C
          (
          E
          +
          Z
          J
          )
        
        ,
      
    
    {\displaystyle \mathbf {CZC^{t}I_{2}=C(E+ZJ)} ,}
  где

  
    
      
        
          C
        
      
    
    {\displaystyle \mathbf {C} }
   — матрица контуров размера n × p (где n — количество независимых контуров, р — количество звеньев)  , в которой i–я строка соответствует независимому контуру i, а j–й столбец соответствует звену j, причём элемент Cij равен 

0, если ребро j не входит в контур i;
1, если ребро входит в контур, и направление ребра соответствует направлению обхода контура;
–1, если ребро входит в контур, и направление ребра противоположно направлению обхода контура.Для каждого ребра задаётся направление, которое обычно ассоциируется с направлением тока в этом ребре;

  
    
      
        
          Z
        
      
    
    {\displaystyle \mathbf {Z} }
   — диагональная матрица сопротивлений размера p × p, в которой диагональный элемент Zii равен сопротивлению i–го ребра, а недиагональные элементы равны нулю;

  
    
      
        
          
            C
          
          
            t
          
        
      
    
    {\displaystyle \mathbf {C} ^{t}}
   — транспонированная матрица контуров;

  
    
      
        
          
            I
          
          
            2
          
        
      
    
    {\displaystyle \mathbf {I} _{2}}
   — матрица-столбец контурных токов размером n × 1. 

  
    
      
        
          J
        
      
    
    {\displaystyle \mathbf {J} }
   — матрица-столбец источников тока размером p × 1, где каждый элемент равен току источника в соответствующем ребре, причём эта величина нулевая, если в данном ребре источник тока отсутствует; положительная, если направление тока источника совпадает с направлением тока в ребре; и отрицательная в противном случае;

  
    
      
        
          E
        
      
    
    {\displaystyle \mathbf {E} }
   — матрица-столбец источников ЭДС размером p × 1, где каждый элемент равен ЭДС источника в соответствующем ребре, причём эта величина нулевая, если в данном ребре источник ЭДС отсутствует; положительная, если направление ЭДС источника совпадает с направлением тока в ребре; и отрицательная в противном случае.

Пример системы уравнений
Для схемы, представленной в предыдущем разделе (см. "Построение системы уравнений", рис. 1), матрицы имеют вид:

  
    
      
        
          C
        
        =
        
          
            (
            
              
                
                  −
                  1
                
                
                  −
                  1
                
                
                  0
                
                
                  1
                
                
                  0
                
                
                  0
                
              
              
                
                  0
                
                
                  1
                
                
                  −
                  1
                
                
                  0
                
                
                  1
                
                
                  0
                
              
              
                
                  1
                
                
                  0
                
                
                  1
                
                
                  0
                
                
                  0
                
                
                  1
                
              
            
            )
          
        
        ;
        
        
          
            I
          
          
            2
          
        
        =
        
          
            (
            
              
                
                  
                    I
                    
                      4
                    
                  
                
              
              
                
                  
                    I
                    
                      5
                    
                  
                
              
              
                
                  
                    I
                    
                      6
                    
                  
                
              
            
            )
          
        
      
    
    {\displaystyle \mathbf {C} ={\begin{pmatrix}-1&-1&0&1&0&0\\0&1&-1&0&1&0\\1&0&1&0&0&1\end{pmatrix}};\quad \mathbf {I} _{2}={\begin{pmatrix}I_{4}\\I_{5}\\I_{6}\end{pmatrix}}}
  

  
    
      
        
          
            C
          
          
            t
          
        
        =
        
          
            (
            
              
                
                  −
                  1
                
                
                  0
                
                
                  1
                
              
              
                
                  −
                  1
                
                
                  1
                
                
                  0
                
              
              
                
                  0
                
                
                  −
                  1
                
                
                  1
                
              
              
                
                  1
                
                
                  0
                
                
                  0
                
              
              
                
                  0
                
                
                  1
                
                
                  0
                
              
              
                
                  0
                
                
                  0
                
                
                  1
                
              
            
            )
          
        
        ;
        
        
          Z
        
        =
        
          
            (
            
              
                
                  
                    Z
                    
                      1
                    
                  
                
                
                  0
                
                
                  0
                
                
                  0
                
                
                  0
                
                
                  0
                
              
              
                
                  0
                
                
                  
                    Z
                    
                      2
                    
                  
                
                
                  0
                
                
                  0
                
                
                  0
                
                
                  0
                
              
              
                
                  0
                
                
                  0
                
                
                  
                    Z
                    
                      3
                    
                  
                
                
                  0
                
                
                  0
                
                
                  0
                
              
              
                
                  0
                
                
                  0
                
                
                  0
                
                
                  
                    Z
                    
                      4
                    
                  
                
                
                  0
                
                
                  0
                
              
              
                
                  0
                
                
                  0
                
                
                  0
                
                
                  0
                
                
                  
                    Z
                    
                      5
                    
                  
                
                
                  0
                
              
              
                
                  0
                
                
                  0
                
                
                  0
                
                
                  0
                
                
                  0
                
                
                  
                    Z
                    
                      6
                    
                  
                
              
            
            )
          
        
        ;
        
        
          J
        
        =
        
          
            (
            
              
                
                  0
                
              
              
                
                  0
                
              
              
                
                  0
                
              
              
                
                  0
                
              
              
                
                  
                    J
                    
                      5
                    
                  
                
              
              
                
                  0
                
              
            
            )
          
        
        ;
        
        
          E
        
        =
        
          
            (
            
              
                
                  0
                
              
              
                
                  0
                
              
              
                
                  0
                
              
              
                
                  
                    E
                    
                      4
                    
                  
                
              
              
                
                  0
                
              
              
                
                  
                    E
                    
                      6
                    
                  
                
              
            
            )
          
        
      
    
    {\displaystyle \mathbf {C} ^{t}={\begin{pmatrix}-1&0&1\\-1&1&0\\0&-1&1\\1&0&0\\0&1&0\\0&0&1\\\end{pmatrix}};\quad \mathbf {Z} ={\begin{pmatrix}Z_{1}&0&0&0&0&0\\0&Z_{2}&0&0&0&0\\0&0&Z_{3}&0&0&0\\0&0&0&Z_{4}&0&0\\0&0&0&0&Z_{5}&0\\0&0&0&0&0&Z_{6}\\\end{pmatrix}};\quad \mathbf {J} ={\begin{pmatrix}0\\0\\0\\0\\J_{5}\\0\end{pmatrix}};\quad \mathbf {E} ={\begin{pmatrix}0\\0\\0\\E_{4}\\0\\E_{6}\end{pmatrix}}}
  
Перемножаем матрицы в соответствии с матричным уравнением:

  
    
      
        
          C
          Z
        
        =
        
          
            (
            
              
                
                  −
                  
                    Z
                    
                      1
                    
                  
                
                
                  −
                  
                    Z
                    
                      2
                    
                  
                
                
                  0
                
                
                  
                    Z
                    
                      4
                    
                  
                
                
                  0
                
                
                  0
                
              
              
                
                  0
                
                
                  
                    Z
                    
                      2
                    
                  
                
                
                  −
                  
                    Z
                    
                      3
                    
                  
                
                
                  0
                
                
                  
                    Z
                    
                      5
                    
                  
                
                
                  0
                
              
              
                
                  
                    Z
                    
                      1
                    
                  
                
                
                  0
                
                
                  
                    Z
                    
                      3
                    
                  
                
                
                  0
                
                
                  0
                
                
                  
                    Z
                    
                      6
                    
                  
                
              
            
            )
          
        
        ;
      
    
    {\displaystyle \mathbf {CZ} ={\begin{pmatrix}-Z_{1}&-Z_{2}&0&Z_{4}&0&0\\0&Z_{2}&-Z_{3}&0&Z_{5}&0\\Z_{1}&0&Z_{3}&0&0&Z_{6}\end{pmatrix}};}
  

  
    
      
        
          C
          Z
          
            C
            
              t
            
          
        
        =
        
          
            (
            
              
                
                  
                    Z
                    
                      1
                    
                  
                  +
                  
                    Z
                    
                      2
                    
                  
                  +
                  
                    Z
                    
                      4
                    
                  
                
                
                  −
                  
                    Z
                    
                      2
                    
                  
                
                
                  −
                  
                    Z
                    
                      1
                    
                  
                
              
              
                
                  −
                  
                    Z
                    
                      2
                    
                  
                
                
                  
                    Z
                    
                      2
                    
                  
                  +
                  
                    Z
                    
                      3
                    
                  
                  +
                  
                    Z
                    
                      5
                    
                  
                
                
                  −
                  
                    Z
                    
                      3
                    
                  
                
              
              
                
                  −
                  
                    Z
                    
                      1
                    
                  
                
                
                  −
                  
                    Z
                    
                      3
                    
                  
                
                
                  
                    Z
                    
                      1
                    
                  
                  +
                  
                    Z
                    
                      3
                    
                  
                  +
                  
                    Z
                    
                      6
                    
                  
                
              
            
            )
          
        
        ;
      
    
    {\displaystyle \mathbf {CZC^{t}} ={\begin{pmatrix}Z_{1}+Z_{2}+Z_{4}&-Z_{2}&-Z_{1}\\-Z_{2}&Z_{2}+Z_{3}+Z_{5}&-Z_{3}\\-Z_{1}&-Z_{3}&Z_{1}+Z_{3}+Z_{6}\end{pmatrix}};}
  

  
    
      
        
          C
          Z
          
            C
            
              t
            
          
          
            I
            
              2
            
          
        
        =
        
          
            (
            
              
                
                  (
                  
                    Z
                    
                      1
                    
                  
                  +
                  
                    Z
                    
                      2
                    
                  
                  +
                  
                    Z
                    
                      4
                    
                  
                  )
                  ⋅
                  
                    I
                    
                      4
                    
                  
                  −
                  
                    Z
                    
                      2
                    
                  
                  ⋅
                  
                    I
                    
                      5
                    
                  
                  −
                  
                    Z
                    
                      1
                    
                  
                  ⋅
                  
                    I
                    
                      6
                    
                  
                
              
              
                
                  −
                  
                    Z
                    
                      2
                    
                  
                  ⋅
                  
                    I
                    
                      4
                    
                  
                  +
                  (
                  
                    Z
                    
                      2
                    
                  
                  +
                  
                    Z
                    
                      3
                    
                  
                  +
                  
                    Z
                    
                      5
                    
                  
                  )
                  ⋅
                  
                    I
                    
                      5
                    
                  
                  −
                  
                    Z
                    
                      3
                    
                  
                  ⋅
                  
                    I
                    
                      6
                    
                  
                
              
              
                
                  −
                  
                    Z
                    
                      1
                    
                  
                  ⋅
                  
                    I
                    
                      4
                    
                  
                  −
                  
                    Z
                    
                      3
                    
                  
                  ⋅
                  
                    I
                    
                      5
                    
                  
                  +
                  (
                  
                    Z
                    
                      1
                    
                  
                  +
                  
                    Z
                    
                      3
                    
                  
                  +
                  
                    Z
                    
                      6
                    
                  
                  )
                  ⋅
                  
                    I
                    
                      6
                    
                  
                
              
            
            )
          
        
        ;
      
    
    {\displaystyle \mathbf {CZC^{t}I_{2}} ={\begin{pmatrix}(Z_{1}+Z_{2}+Z_{4})\cdot I_{4}-Z_{2}\cdot I_{5}-Z_{1}\cdot I_{6}\\-Z_{2}\cdot I_{4}+(Z_{2}+Z_{3}+Z_{5})\cdot I_{5}-Z_{3}\cdot I_{6}\\-Z_{1}\cdot I_{4}-Z_{3}\cdot I_{5}+(Z_{1}+Z_{3}+Z_{6})\cdot I_{6}\end{pmatrix}};}
  

  
    
      
        
          E
          +
          Z
          J
        
        =
        
          
            (
            
              
                
                  0
                
              
              
                
                  0
                
              
              
                
                  0
                
              
              
                
                  
                    E
                    
                      4
                    
                  
                
              
              
                
                  
                    Z
                    
                      5
                    
                  
                  
                    J
                    
                      5
                    
                  
                
              
              
                
                  
                    E
                    
                      6
                    
                  
                
              
            
            )
          
        
        ;
        
        
          C
          (
          E
          +
          Z
          J
          )
        
        =
        
          
            (
            
              
                
                  
                    E
                    
                      4
                    
                  
                
              
              
                
                  
                    Z
                    
                      5
                    
                  
                  
                    J
                    
                      5
                    
                  
                
              
              
                
                  
                    E
                    
                      6
                    
                  
                
              
            
            )
          
        
      
    
    {\displaystyle \mathbf {E+ZJ} ={\begin{pmatrix}0\\0\\0\\E_{4}\\Z_{5}J_{5}\\E_{6}\end{pmatrix}};\quad \mathbf {C(E+ZJ)} ={\begin{pmatrix}E_{4}\\Z_{5}J_{5}\\E_{6}\end{pmatrix}}}
  
Раскрывая матричную запись, получаем следующую систему уравнений:

  
    
      
        
          
            {
            
              
                
                  (
                  
                    Z
                    
                      1
                    
                  
                  +
                  
                    Z
                    
                      2
                    
                  
                  +
                  
                    Z
                    
                      4
                    
                  
                  )
                  ⋅
                  
                    I
                    
                      4
                    
                  
                  −
                  
                    Z
                    
                      2
                    
                  
                  ⋅
                  
                    I
                    
                      5
                    
                  
                  −
                  
                    Z
                    
                      1
                    
                  
                  ⋅
                  
                    I
                    
                      6
                    
                  
                  =
                  
                    E
                    
                      4
                    
                  
                
              
              
                
                  −
                  
                    Z
                    
                      2
                    
                  
                  ⋅
                  
                    I
                    
                      4
                    
                  
                  +
                  (
                  
                    Z
                    
                      2
                    
                  
                  +
                  
                    Z
                    
                      3
                    
                  
                  +
                  
                    Z
                    
                      5
                    
                  
                  )
                  ⋅
                  
                    I
                    
                      5
                    
                  
                  −
                  
                    Z
                    
                      3
                    
                  
                  ⋅
                  
                    I
                    
                      6
                    
                  
                  =
                  
                    Z
                    
                      5
                    
                  
                  
                    J
                    
                      5
                    
                  
                
              
              
                
                  −
                  
                    Z
                    
                      1
                    
                  
                  ⋅
                  
                    I
                    
                      4
                    
                  
                  −
                  
                    Z
                    
                      3
                    
                  
                  ⋅
                  
                    I
                    
                      5
                    
                  
                  +
                  (
                  
                    Z
                    
                      1
                    
                  
                  +
                  
                    Z
                    
                      3
                    
                  
                  +
                  
                    Z
                    
                      6
                    
                  
                  )
                  ⋅
                  
                    I
                    
                      6
                    
                  
                  =
                  
                    E
                    
                      6
                    
                  
                
              
            
            
          
        
        .
      
    
    {\displaystyle {\begin{cases}(Z_{1}+Z_{2}+Z_{4})\cdot I_{4}-Z_{2}\cdot I_{5}-Z_{1}\cdot I_{6}=E_{4}\\-Z_{2}\cdot I_{4}+(Z_{2}+Z_{3}+Z_{5})\cdot I_{5}-Z_{3}\cdot I_{6}=Z_{5}J_{5}\\-Z_{1}\cdot I_{4}-Z_{3}\cdot I_{5}+(Z_{1}+Z_{3}+Z_{6})\cdot I_{6}=E_{6}\end{cases}}.}

Примечания
См. также
Правила Кирхгофа
Эквивалентная схема
Источник напряжения
Источник тока

Литература
Бессонов Л.А. Теоретические основы электротехники. Электрические цепи. — М.: Гардарики, 2002. — 638 с. — ISBN 5-8297-0026-3.